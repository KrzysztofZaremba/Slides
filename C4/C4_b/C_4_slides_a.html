<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Class 4b: Simple Linear Regression diagnostics</title>
    <meta charset="utf-8" />
    <meta name="author" content="Business Forecasting" />
    <script src="libs/header-attrs-2.22/header-attrs.js"></script>
    <script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
    <link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
    <script src="libs/datatables-binding-0.28/datatables.js"></script>
    <script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
    <link href="libs/dt-core-1.13.4/css/jquery.dataTables.min.css" rel="stylesheet" />
    <link href="libs/dt-core-1.13.4/css/jquery.dataTables.extra.css" rel="stylesheet" />
    <script src="libs/dt-core-1.13.4/js/jquery.dataTables.min.js"></script>
    <link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
    <script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
    <script src="libs/plotly-binding-4.10.2/plotly.js"></script>
    <script src="libs/typedarray-0.1/typedarray.min.js"></script>
    <link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
    <script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# Class 4b: Simple Linear Regression diagnostics
]
.author[
### Business Forecasting
]

---

&lt;style type="text/css"&gt;
.remark-slide-content {
    font-size: 20px;
}


&lt;/style&gt;







---
## Roadmap


### This class
- Testing assumptions behind residuals
  - Linearity
  - Constant Variance
  - Uncorrelated Residuals
  - Normality
  
---


Let's revisit the assumptions behind linear model:


0. Model is linear in the parameter and with additive error term
1. `\(E(u_i)=0\)`
2. `\(E(u_i|x)=0\)`
3. `\(Var(u_i)=\sigma^2\)`
4. `\(cov(u_i,u_j)=0\)`

Additional assumption needed for hypothesis testing and confidence intervals:

5. `\(u_i \sim N(0,\sigma)\)`



---
### Assumptions


Visualizing residuals, we can test: 
- Linearity
- Constant Variance (homoskedasticity)
- Uncorrelated errors

---

With vizuale and numerical tests we can analyze:
- Normality

---

### Linearity diagnostic

1. Plot residuals against fitted values of y `\(\hat{y}\)`
2. Check if residuals have systematic non-linear pattern

&lt;img src="C_4_slides_a_files/figure-html/unnamed-chunk-1-1.png" width="100%" /&gt;

 
---
### Linearity diagnostic

&lt;img src="C_4_slides_a_files/figure-html/unnamed-chunk-2-1.png" width="100%" /&gt;

---
### Constant variance (homoskedasticity)  diagnostic


1. Plot residuals against fitted values of y `\(\hat{y}\)`
2. Check if variance changes as `\(\hat{y}\)` changes (heteroskedasticity)


&lt;img src="C_4_slides_a_files/figure-html/unnamed-chunk-3-1.png" width="100%" /&gt;

---
### Constant variance (homoskedasticity) diagnostic


&lt;img src="C_4_slides_a_files/figure-html/unnamed-chunk-4-1.png" width="100%" /&gt;


---
What goes wrong here?

&lt;img src="C_4_slides_a_files/figure-html/unnamed-chunk-5-1.png" width="100%" /&gt;
---

What goes wrong here?

&lt;img src="C_4_slides_a_files/figure-html/unnamed-chunk-6-1.png" width="100%" /&gt;


---
### Correlation of error terms

1. Plot fitted residuals vs their value in previous observation `\(e_i\)` vs `\(e_{i-1}\)`
2. So `\(e_2\)` vs `\(e_1\)`, `\(e_5\)` vs `\(e_4\)` etc

&lt;img src="C_4_slides_a_files/figure-html/unnamed-chunk-7-1.png" width="100%" /&gt;


---
### Correlation of error terms

1. We can also calculate the correlation with other lags
  - Example: `\(e_i\)` vs `\(e_{i-3}\)` 
  - Note down correlation at each lag: `\(\small \rho(e_i,e_{i-1})\)`, `\(\small  \rho(e_i,e_{i-2})\)`, `\(\small  \rho(e_i,e_{i-3})\)`

&lt;img src="C_4_slides_a_files/figure-html/unnamed-chunk-8-1.png" width="100%" /&gt;
---

### Normality

We can start by looking at histograms
- Some are obvious

&lt;img src="C_4_slides_a_files/figure-html/unnamed-chunk-9-1.png" width="100%" /&gt;

---
### Normality
We can start by looking at histograms
- Some are obvious


&lt;img src="C_4_slides_a_files/figure-html/unnamed-chunk-10-1.png" width="100%" /&gt;

---
### Normality
We can start by looking at histograms
- Some are **NOT** obvious
- Then we need a different test



&lt;img src="C_4_slides_a_files/figure-html/unnamed-chunk-11-1.png" width="100%" /&gt;

---
### Normality


**Q-Q Plot**: Quantlie-Quantile Plot

- Comparing quantiles of our data to what they should be if they come from normal distribution


- Procedure:
  - Standardize residuals

--
  - Sort them

--
  - Check which quantile they represent
    - This is equivalent to checking cumulative probability: `\(CP_i=\frac{Index}{n+1}\)`
    - Where index is the number of observation if we sort if from smallest to  largest 
        - 1 is the smallest, 2 is the second smallest, ..., n is the largest
    - In other words, what share of data is smaller than this observation

--
  - Compare them to quantiles from standard normal

--
  - If our distribution is normal, the quantiles should be similar

---
### Q-Q plot

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-78d6a3d12d9b5e0b0ad7" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-78d6a3d12d9b5e0b0ad7">{"x":{"filter":"none","vertical":false,"fillContainer":false,"data":[[-1.681,-0.6909999999999999,4.676,0.212,0.388,5.145,1.383,-3.795,-2.061,-1.337,3.672,1.079,1.202,0.332,-1.668,5.361,1.494,-5.9,2.104,-1.418,-3.203,-0.654,-3.078,-2.187,-1.875,-5.06,2.513,0.46,-3.414,3.761,1.279,-0.885,2.685,2.634,2.465,2.066,1.662,-0.186,-0.918,-1.141,-2.084,-0.624,-3.796,6.507,3.624,-3.369,-1.209,-1.4,2.34,-0.25,0.76,-0.08599999999999999,-0.129,4.106,-0.677,4.549,-4.646,1.754,0.372,0.648,1.139,-1.507,-1,-3.056,-3.215,0.911,1.345,0.159,2.767,6.15,-1.473,-6.928,3.017,-2.128,-2.064,3.077,-0.854,-3.662,0.544,-0.417,0.017,1.156,-1.112,1.933,-0.661,0.995,3.291,1.306,-0.978,3.446,2.981,1.645,0.716,-1.884,4.082,-1.801,6.562,4.598,-0.707,-3.079],[-0.713,-0.351,1.609,-0.022,0.043,1.78,0.406,-1.485,-0.852,-0.587,1.242,0.295,0.34,0.022,-0.708,1.859,0.447,-2.254,0.669,-0.617,-1.269,-0.338,-1.223,-0.898,-0.784,-1.947,0.819,0.06900000000000001,-1.346,1.274,0.368,-0.422,0.881,0.863,0.801,0.655,0.508,-0.167,-0.434,-0.516,-0.86,-0.327,-1.485,2.277,1.224,-1.329,-0.541,-0.61,0.755,-0.19,0.178,-0.13,-0.146,1.4,-0.346,1.562,-1.796,0.541,0.037,0.138,0.317,-0.649,-0.464,-1.215,-1.273,0.234,0.392,-0.041,0.911,2.147,-0.637,-2.629,1.003,-0.876,-0.853,1.025,-0.411,-1.436,0.1,-0.251,-0.093,0.323,-0.505,0.607,-0.34,0.264,1.103,0.378,-0.456,1.159,0.99,0.502,0.162,-0.787,1.392,-0.757,2.297,1.58,-0.357,-1.223],[23,39,95,51,54,96,69,5.5,19,29,89,62,65,52,24,97,70,2,76,27,11,42,12.5,15,21,3,79,55,8,90,66,36,81,80,78,75,72,46,35,31,17,43,5.5,99,88,9,30,28,77,45,59,48,47,92,40,93,4,73,53,57,63,25,33,14,10,60,68,50,82,98,26,1,84,16,18,85,37,7,56,44,49,64,32,74,41,61,86,67,34,87,83,71,58,20,91,22,100,94,38,12.5],[0.228,0.386,0.9409999999999999,0.505,0.535,0.95,0.6830000000000001,0.054,0.188,0.287,0.881,0.614,0.644,0.515,0.238,0.96,0.6929999999999999,0.02,0.752,0.267,0.109,0.416,0.124,0.149,0.208,0.03,0.782,0.545,0.079,0.891,0.653,0.356,0.802,0.792,0.772,0.743,0.713,0.455,0.347,0.307,0.168,0.426,0.054,0.98,0.871,0.089,0.297,0.277,0.762,0.446,0.584,0.475,0.465,0.911,0.396,0.921,0.04,0.723,0.525,0.5639999999999999,0.624,0.248,0.327,0.139,0.099,0.594,0.673,0.495,0.8120000000000001,0.97,0.257,0.01,0.832,0.158,0.178,0.842,0.366,0.06900000000000001,0.554,0.436,0.485,0.634,0.317,0.733,0.406,0.604,0.851,0.663,0.337,0.861,0.822,0.703,0.574,0.198,0.901,0.218,0.99,0.931,0.376,0.124],[-0.745,-0.29,1.563,0.013,0.08799999999999999,1.645,0.476,-1.607,-0.885,-0.5620000000000001,1.18,0.29,0.369,0.038,-0.713,1.751,0.504,-2.054,0.681,-0.622,-1.232,-0.212,-1.155,-1.041,-0.8129999999999999,-1.881,0.779,0.113,-1.412,1.232,0.393,-0.369,0.849,0.8129999999999999,0.745,0.653,0.5620000000000001,-0.113,-0.393,-0.504,-0.962,-0.187,-1.607,2.054,1.131,-1.347,-0.533,-0.592,0.713,-0.136,0.212,-0.063,-0.08799999999999999,1.347,-0.264,1.412,-1.751,0.592,0.063,0.161,0.316,-0.681,-0.448,-1.085,-1.287,0.238,0.448,-0.013,0.885,1.881,-0.653,-2.326,0.962,-1.003,-0.923,1.003,-0.342,-1.483,0.136,-0.161,-0.038,0.342,-0.476,0.622,-0.238,0.264,1.041,0.421,-0.421,1.085,0.923,0.533,0.187,-0.849,1.287,-0.779,2.326,1.483,-0.316,-1.155]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Residuals<\/th>\n      <th>Standardized_Residuals<\/th>\n      <th>Index<\/th>\n      <th>Cumulative_Probability<\/th>\n      <th>Quantile_Normal<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"searching":false,"initComplete":"function(settings, json) {\n$(this.api().table().container()).css({'font-size': '12px'});\n}","columnDefs":[{"className":"dt-right","targets":[0,1,2,3,4]}],"order":[],"autoWidth":false,"orderClasses":false},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":["options.initComplete"],"jsHooks":[]}</script>
---
### Q-Q plot

- Next, we plot the sample quantiles vs the standard normal quantiles
- If they are similar, they should be on the straight line

### Q-Q plot
.pull-left[


<div id="htmlwidget-1d8afdd71096e1493583" style="width:400px;height:350px;" class="plotly html-widget "></div>
<script type="application/json" data-for="htmlwidget-1d8afdd71096e1493583">{"x":{"data":[{"orientation":"v","width":[0.40000000000000036,0.40000000000000036,0.40000000000000036,0.39999999999999991,0.39999999999999991,0.40000000000000036,0.39999999999999991,0.39999999999999991,0.39999999999999991,0.39999999999999991,0.40000000000000036,0.40000000000000036,0.39999999999999947,0.40000000000000036,0.39999999999999947],"base":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"x":[-2.7999999999999998,-2.4000000000000004,-2,-1.5999999999999999,-1.2,-0.79999999999999982,-0.39999999999999969,2.2204460492503131e-16,0.40000000000000013,0.80000000000000004,1.2000000000000002,1.6000000000000005,2.0000000000000004,2.4000000000000004,2.8000000000000003],"y":[0.025000000000000005,0.025000000000000005,0.024999999999999977,0.10000000000000002,0.17500000000000004,0.3499999999999997,0.40000000000000008,0.37500000000000006,0.35000000000000009,0.25000000000000006,0.19999999999999982,0.12499999999999989,0.050000000000000072,0.049999999999999954,0],"text":["density: 0.025","density: 0.025","density: 0.025","density: 0.100","density: 0.175","density: 0.350","density: 0.400","density: 0.375","density: 0.350","density: 0.250","density: 0.200","density: 0.125","density: 0.050","density: 0.050","density: 0.000"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(0,255,0,0.7)","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"}},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-3,-2.9399999999999999,-2.8799999999999999,-2.8199999999999998,-2.7599999999999998,-2.7000000000000002,-2.6400000000000001,-2.5800000000000001,-2.52,-2.46,-2.3999999999999999,-2.3399999999999999,-2.2800000000000002,-2.2199999999999998,-2.1600000000000001,-2.1000000000000001,-2.04,-1.98,-1.9199999999999999,-1.8600000000000001,-1.8,-1.74,-1.6800000000000002,-1.6200000000000001,-1.5600000000000001,-1.5,-1.4399999999999999,-1.3800000000000001,-1.3200000000000001,-1.26,-1.2000000000000002,-1.1400000000000001,-1.0800000000000001,-1.02,-0.95999999999999996,-0.89999999999999991,-0.83999999999999986,-0.78000000000000025,-0.7200000000000002,-0.66000000000000014,-0.60000000000000009,-0.54000000000000004,-0.47999999999999998,-0.41999999999999993,-0.36000000000000032,-0.30000000000000027,-0.24000000000000021,-0.18000000000000016,-0.12000000000000011,-0.060000000000000053,0,0.060000000000000053,0.12000000000000011,0.17999999999999972,0.23999999999999977,0.29999999999999982,0.35999999999999988,0.41999999999999993,0.47999999999999998,0.54000000000000004,0.59999999999999964,0.6599999999999997,0.71999999999999975,0.7799999999999998,0.83999999999999986,0.89999999999999991,0.95999999999999996,1.0199999999999996,1.0800000000000001,1.1399999999999997,1.2000000000000002,1.2599999999999998,1.3200000000000003,1.3799999999999999,1.4399999999999995,1.5,1.5599999999999996,1.6200000000000001,1.6799999999999997,1.7400000000000002,1.7999999999999998,1.8599999999999994,1.9199999999999999,1.9799999999999995,2.04,2.0999999999999996,2.1600000000000001,2.2199999999999998,2.2799999999999994,2.3399999999999999,2.3999999999999995,2.46,2.5199999999999996,2.5800000000000001,2.6399999999999997,2.7000000000000002,2.7599999999999998,2.8199999999999994,2.8799999999999999,2.9399999999999995,3],"y":[0.0044318484119380075,0.0052963438653110201,0.0063067263962659275,0.0074828725257805638,0.0088464543982372315,0.010420934814422592,0.012231526351277971,0.01430510899414969,0.016670100837381057,0.019356276731736961,0.022394530294842899,0.02581657547158769,0.02965458484734125,0.033940763182449214,0.038706856147455608,0.043983595980427191,0.049800087735070775,0.056183141903868049,0.063156561435198655,0.07074039345698338,0.078950158300894149,0.087796070610905622,0.097282269331467469,0.1074060751134838,0.11815729505958227,0.12951759566589174,0.14145996522483878,0.1539482867626337,0.16693704174171381,0.18037116322708033,0.19418605498321292,0.20830779004710831,0.22265349875176113,0.23713195201937959,0.25164434109811712,0.26608524989875487,0.28034381083962062,0.29430502978832507,0.30785126046985289,0.32086380377117246,0.33322460289179967,0.34481800143933333,0.35553252850599709,0.36526267262215389,0.37391060537312837,0.38138781546052408,0.38761661512501411,0.3925314831204289,0.3960802117936561,0.39822483019560695,0.3989422804014327,0.39822483019560695,0.3960802117936561,0.39253148312042896,0.38761661512501416,0.38138781546052414,0.37391060537312842,0.36526267262215389,0.35553252850599709,0.34481800143933333,0.33322460289179973,0.32086380377117257,0.30785126046985301,0.29430502978832518,0.28034381083962062,0.26608524989875487,0.25164434109811712,0.2371319520193797,0.22265349875176113,0.20830779004710845,0.19418605498321292,0.18037116322708038,0.16693704174171375,0.15394828676263372,0.14145996522483889,0.12951759566589174,0.11815729505958236,0.1074060751134838,0.097282269331467539,0.087796070610905594,0.078950158300894177,0.070740393456983464,0.063156561435198655,0.05618314190386809,0.049800087735070775,0.043983595980427233,0.038706856147455608,0.033940763182449214,0.029654584847341316,0.02581657547158769,0.022394530294842931,0.019356276731736961,0.016670100837381078,0.01430510899414969,0.012231526351277987,0.010420934814422592,0.0088464543982372315,0.0074828725257805734,0.0063067263962659275,0.0052963438653110245,0.0044318484119380075],"text":"","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,0,255,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":24.349641226353555,"r":7.3059360730593621,"b":38.303979125896944,"l":43.105022831050235},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-3.2999999999999998,3.2999999999999998],"tickmode":"array","ticktext":["-2","0","2"],"tickvals":[-2,0,2],"categoryorder":"array","categoryarray":["-2","0","2"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Standardized Residuals","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.020000000000000004,0.4200000000000001],"tickmode":"array","ticktext":["0.0","0.1","0.2","0.3","0.4"],"tickvals":[0,0.099999999999999992,0.20000000000000001,0.30000000000000004,0.40000000000000002],"categoryorder":"array","categoryarray":["0.0","0.1","0.2","0.3","0.4"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Density","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498}},"hovermode":"closest","width":400,"height":350,"barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"40bc778f3a08":{"x":{},"y":{},"type":"bar"},"40bc15602afe":{"x":{}}},"cur_data":"40bc778f3a08","visdat":{"40bc778f3a08":["function (y) ","x"],"40bc15602afe":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
]
.pull-right[


<div id="htmlwidget-45c9d2fb65faa85b7b77" style="width:400px;height:350px;" class="plotly html-widget "></div>
<script type="application/json" data-for="htmlwidget-45c9d2fb65faa85b7b77">{"x":{"data":[{"x":[-2.5758293035488999,-2.1700903775845601,-1.9599639845400538,-1.8119106729525978,-1.6953977102721358,-1.5981931399228173,-1.5141018876192833,-1.4395314709384557,-1.3722038089987258,-1.3105791121681289,-1.2535654384704509,-1.2003588580308591,-1.1503493803760079,-1.1030625561995975,-1.058121617684777,-1.0152220332170281,-0.97411387705930896,-0.93458929107348021,-0.89647336400191624,-0.85961736424191137,-0.82389363033855756,-0.78919165265822233,-0.75541502636046931,-0.72247905192806272,-0.69030882393303405,-0.65883769273618786,-0.62800601443756965,-0.59776012604247841,-0.56805149833898294,-0.53883603027845028,-0.51007345696859474,-0.48172684958473022,-0.45376219016987929,-0.4261480078412781,-0.39885506564233686,-0.3718560893850747,-0.34512553147047226,-0.31863936396437514,-0.29237489622680418,-0.26631061320409494,-0.24042603114230793,-0.21470156800174453,-0.18911842627279249,-0.16365848623314122,-0.1383042079614045,-0.11303854064456507,-0.087844837895871677,-0.062706777943213832,-0.037608287661255936,-0.012533469508069278,0.012533469508069278,0.037608287661255936,0.062706777943213832,0.087844837895871816,0.11303854064456521,0.13830420796140463,0.16365848623314108,0.18911842627279238,0.21470156800174439,0.24042603114230793,0.26631061320409494,0.29237489622680418,0.31863936396437514,0.34512553147047226,0.3718560893850747,0.39885506564233686,0.42614800784127826,0.45376219016987962,0.48172684958473033,0.51007345696859452,0.53883603027845017,0.56805149833898272,0.59776012604247841,0.62800601443756965,0.65883769273618786,0.69030882393303405,0.72247905192806272,0.75541502636046931,0.78919165265822233,0.82389363033855756,0.85961736424191171,0.89647336400191591,0.93458929107347977,0.97411387705930896,1.0152220332170281,1.058121617684777,1.1030625561995975,1.1503493803760079,1.2003588580308591,1.2535654384704509,1.3105791121681289,1.3722038089987263,1.4395314709384559,1.514101887619284,1.5981931399228169,1.6953977102721358,1.8119106729525971,1.9599639845400536,2.1700903775845601,2.5758293035488999],"y":[-2.6289534091967508,-2.2535566155643489,-1.9468121538413745,-1.7956309548493374,-1.4852347733439466,-1.4848696013657048,-1.4363017282595674,-1.3457390776556417,-1.3293063386347683,-1.2730698539855561,-1.2686877902466565,-1.2234064649446938,-1.223041292966452,-1.215007509445136,-0.89767306035315431,-0.8761279136368979,-0.86006034659426589,-0.85275690702943319,-0.85166139109470829,-0.78702595094593863,-0.78373940314176394,-0.75671667675188281,-0.71289603936288659,-0.70814880364574528,-0.64935611514884195,-0.63694026788862634,-0.61685580908533633,-0.61028271347698682,-0.58727687884776381,-0.54053486563283448,-0.51570317111240316,-0.50511318374339575,-0.46421392218033247,-0.45618013865901652,-0.43426981996451841,-0.42221914468254435,-0.41089881335705369,-0.35721853255553315,-0.35137578090366695,-0.3462633732082841,-0.34042062155641789,-0.33786441770872644,-0.32690925836147738,-0.25131865886545873,-0.19033493849910552,-0.1669639318916408,-0.14614912913186756,-0.1304467340674772,-0.092834020308588699,-0.040979599398276396,-0.02162548455146969,0.022195152837526634,0.036802031967192068,0.042644783619058248,0.068937166052456048,0.099611612224753468,0.13758949796188361,0.16242119248231485,0.17848875952494683,0.23362972823943387,0.26430417441173126,0.29497862058402868,0.31688893927852685,0.32309686290863465,0.33989477390774991,0.36801301623235588,0.37787265964488009,0.39211436679630385,0.40599090196948606,0.44652499155430764,0.50166596026879473,0.50787388389890242,0.54146970589713295,0.6068354900023859,0.65540336310852332,0.66927989828170564,0.75546048514673159,0.80110698242693612,0.81863523738253463,0.86282104674977267,0.88144481764009608,0.9113889198559102,0.98953572319962024,1.0026819144163193,1.0245922331108175,1.1027390364545275,1.1593406930819812,1.2243413052089924,1.2418695601645908,1.2743698662280964,1.3915900712436615,1.4003541987214607,1.5621253850825056,1.5800188120163454,1.6085022263191935,1.7797678841145206,1.8586450314147138,2.1467657222473653,2.2771321184796287,2.2972165772829189],"text":["Quantile: 0.01","Quantile: 0.02","Quantile: 0.03","Quantile: 0.04","Quantile: 0.05","Quantile: 0.059","Quantile: 0.069","Quantile: 0.079","Quantile: 0.089","Quantile: 0.099","Quantile: 0.109","Quantile: 0.119","Quantile: 0.129","Quantile: 0.139","Quantile: 0.149","Quantile: 0.158","Quantile: 0.168","Quantile: 0.178","Quantile: 0.188","Quantile: 0.198","Quantile: 0.208","Quantile: 0.218","Quantile: 0.228","Quantile: 0.238","Quantile: 0.248","Quantile: 0.257","Quantile: 0.267","Quantile: 0.277","Quantile: 0.287","Quantile: 0.297","Quantile: 0.307","Quantile: 0.317","Quantile: 0.327","Quantile: 0.337","Quantile: 0.347","Quantile: 0.356","Quantile: 0.366","Quantile: 0.376","Quantile: 0.386","Quantile: 0.396","Quantile: 0.406","Quantile: 0.416","Quantile: 0.426","Quantile: 0.436","Quantile: 0.446","Quantile: 0.455","Quantile: 0.465","Quantile: 0.475","Quantile: 0.485","Quantile: 0.495","Quantile: 0.505","Quantile: 0.515","Quantile: 0.525","Quantile: 0.535","Quantile: 0.545","Quantile: 0.554","Quantile: 0.564","Quantile: 0.574","Quantile: 0.584","Quantile: 0.594","Quantile: 0.604","Quantile: 0.614","Quantile: 0.624","Quantile: 0.634","Quantile: 0.644","Quantile: 0.653","Quantile: 0.663","Quantile: 0.673","Quantile: 0.683","Quantile: 0.693","Quantile: 0.703","Quantile: 0.713","Quantile: 0.723","Quantile: 0.733","Quantile: 0.743","Quantile: 0.752","Quantile: 0.762","Quantile: 0.772","Quantile: 0.782","Quantile: 0.792","Quantile: 0.802","Quantile: 0.812","Quantile: 0.822","Quantile: 0.832","Quantile: 0.842","Quantile: 0.851","Quantile: 0.861","Quantile: 0.871","Quantile: 0.881","Quantile: 0.891","Quantile: 0.901","Quantile: 0.911","Quantile: 0.921","Quantile: 0.931","Quantile: 0.941","Quantile: 0.95","Quantile: 0.96","Quantile: 0.97","Quantile: 0.98","Quantile: 0.99"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(67,65,138,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(67,65,138,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-3.2999999999999998,3.2999999999999998],"y":[-3.2999999999999998,3.2999999999999998],"text":"intercept: 0<br />slope: 1","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(255,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":24.349641226353555,"r":7.3059360730593621,"b":38.303979125896944,"l":37.260273972602747},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-3.2999999999999998,3.2999999999999998],"tickmode":"array","ticktext":["-2","0","2"],"tickvals":[-2,0,2],"categoryorder":"array","categoryarray":["-2","0","2"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"theoretical","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"scaleanchor":"y","scaleratio":1,"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-3.2999999999999998,3.2999999999999998],"tickmode":"array","ticktext":["-2","0","2"],"tickvals":[-2,0,2],"categoryorder":"array","categoryarray":["-2","0","2"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"sample","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"scaleanchor":"x","scaleratio":1,"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498}},"hovermode":"closest","width":400,"height":350,"barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"40bc49e0728f":{"sample":{},"type":"scatter"},"40bc2b3d4173":{"intercept":{},"slope":{}}},"cur_data":"40bc49e0728f","visdat":{"40bc49e0728f":["function (y) ","x"],"40bc2b3d4173":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
]



---
### Q-Q plot
.pull-left[


<div id="htmlwidget-2fec48fe06b297e95157" style="width:400px;height:350px;" class="plotly html-widget "></div>
<script type="application/json" data-for="htmlwidget-2fec48fe06b297e95157">{"x":{"data":[{"orientation":"v","width":[0.40000000000000036,0.40000000000000036,0.40000000000000036,0.39999999999999991,0.39999999999999991,0.40000000000000036,0.39999999999999991,0.39999999999999991,0.39999999999999991,0.39999999999999991,0.40000000000000036,0.40000000000000036,0.39999999999999947,0.40000000000000036,0.39999999999999947],"base":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"x":[-2.7999999999999998,-2.4000000000000004,-2,-1.5999999999999999,-1.2,-0.79999999999999982,-0.39999999999999969,2.2204460492503131e-16,0.40000000000000013,0.80000000000000004,1.2000000000000002,1.6000000000000005,2.0000000000000004,2.4000000000000004,2.8000000000000003],"y":[0,0,0,0,0.20202020202020204,0.60606060606060552,0.580808080808081,0.30303030303030309,0.32828282828282834,0.1767676767676768,0.10101010101010093,0.050505050505050463,0.050505050505050574,0.050505050505050463,0.050505050505050574],"text":["density: 0.00000000","density: 0.00000000","density: 0.00000000","density: 0.00000000","density: 0.20202020","density: 0.60606061","density: 0.58080808","density: 0.30303030","density: 0.32828283","density: 0.17676768","density: 0.10101010","density: 0.05050505","density: 0.05050505","density: 0.05050505","density: 0.05050505"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(0,255,0,0.7)","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"}},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-3,-2.9399999999999999,-2.8799999999999999,-2.8199999999999998,-2.7599999999999998,-2.7000000000000002,-2.6400000000000001,-2.5800000000000001,-2.52,-2.46,-2.3999999999999999,-2.3399999999999999,-2.2800000000000002,-2.2199999999999998,-2.1600000000000001,-2.1000000000000001,-2.04,-1.98,-1.9199999999999999,-1.8600000000000001,-1.8,-1.74,-1.6800000000000002,-1.6200000000000001,-1.5600000000000001,-1.5,-1.4399999999999999,-1.3800000000000001,-1.3200000000000001,-1.26,-1.2000000000000002,-1.1400000000000001,-1.0800000000000001,-1.02,-0.95999999999999996,-0.89999999999999991,-0.83999999999999986,-0.78000000000000025,-0.7200000000000002,-0.66000000000000014,-0.60000000000000009,-0.54000000000000004,-0.47999999999999998,-0.41999999999999993,-0.36000000000000032,-0.30000000000000027,-0.24000000000000021,-0.18000000000000016,-0.12000000000000011,-0.060000000000000053,0,0.060000000000000053,0.12000000000000011,0.17999999999999972,0.23999999999999977,0.29999999999999982,0.35999999999999988,0.41999999999999993,0.47999999999999998,0.54000000000000004,0.59999999999999964,0.6599999999999997,0.71999999999999975,0.7799999999999998,0.83999999999999986,0.89999999999999991,0.95999999999999996,1.0199999999999996,1.0800000000000001,1.1399999999999997,1.2000000000000002,1.2599999999999998,1.3200000000000003,1.3799999999999999,1.4399999999999995,1.5,1.5599999999999996,1.6200000000000001,1.6799999999999997,1.7400000000000002,1.7999999999999998,1.8599999999999994,1.9199999999999999,1.9799999999999995,2.04,2.0999999999999996,2.1600000000000001,2.2199999999999998,2.2799999999999994,2.3399999999999999,2.3999999999999995,2.46,2.5199999999999996,2.5800000000000001,2.6399999999999997,2.7000000000000002,2.7599999999999998,2.8199999999999994,2.8799999999999999,2.9399999999999995,3],"y":[0.0044318484119380075,0.0052963438653110201,0.0063067263962659275,0.0074828725257805638,0.0088464543982372315,0.010420934814422592,0.012231526351277971,0.01430510899414969,0.016670100837381057,0.019356276731736961,0.022394530294842899,0.02581657547158769,0.02965458484734125,0.033940763182449214,0.038706856147455608,0.043983595980427191,0.049800087735070775,0.056183141903868049,0.063156561435198655,0.07074039345698338,0.078950158300894149,0.087796070610905622,0.097282269331467469,0.1074060751134838,0.11815729505958227,0.12951759566589174,0.14145996522483878,0.1539482867626337,0.16693704174171381,0.18037116322708033,0.19418605498321292,0.20830779004710831,0.22265349875176113,0.23713195201937959,0.25164434109811712,0.26608524989875487,0.28034381083962062,0.29430502978832507,0.30785126046985289,0.32086380377117246,0.33322460289179967,0.34481800143933333,0.35553252850599709,0.36526267262215389,0.37391060537312837,0.38138781546052408,0.38761661512501411,0.3925314831204289,0.3960802117936561,0.39822483019560695,0.3989422804014327,0.39822483019560695,0.3960802117936561,0.39253148312042896,0.38761661512501416,0.38138781546052414,0.37391060537312842,0.36526267262215389,0.35553252850599709,0.34481800143933333,0.33322460289179973,0.32086380377117257,0.30785126046985301,0.29430502978832518,0.28034381083962062,0.26608524989875487,0.25164434109811712,0.2371319520193797,0.22265349875176113,0.20830779004710845,0.19418605498321292,0.18037116322708038,0.16693704174171375,0.15394828676263372,0.14145996522483889,0.12951759566589174,0.11815729505958236,0.1074060751134838,0.097282269331467539,0.087796070610905594,0.078950158300894177,0.070740393456983464,0.063156561435198655,0.05618314190386809,0.049800087735070775,0.043983595980427233,0.038706856147455608,0.033940763182449214,0.029654584847341316,0.02581657547158769,0.022394530294842931,0.019356276731736961,0.016670100837381078,0.01430510899414969,0.012231526351277987,0.010420934814422592,0.0088464543982372315,0.0074828725257805734,0.0063067263962659275,0.0052963438653110245,0.0044318484119380075],"text":"","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,0,255,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":24.349641226353555,"r":7.3059360730593621,"b":38.303979125896944,"l":43.105022831050235},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-3.2999999999999998,3.2999999999999998],"tickmode":"array","ticktext":["-2","0","2"],"tickvals":[-2,0,2],"categoryorder":"array","categoryarray":["-2","0","2"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Standardized Residuals","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.030303030303030276,0.6363636363636358],"tickmode":"array","ticktext":["0.0","0.2","0.4","0.6"],"tickvals":[0,0.20000000000000001,0.40000000000000002,0.60000000000000009],"categoryorder":"array","categoryarray":["0.0","0.2","0.4","0.6"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Density","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498}},"hovermode":"closest","width":400,"height":350,"barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"40bcbb41920":{"x":{},"y":{},"type":"bar"},"40bc62404fa9":{"x":{}}},"cur_data":"40bcbb41920","visdat":{"40bcbb41920":["function (y) ","x"],"40bc62404fa9":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
]
.pull-right[


<div id="htmlwidget-f747bf3b0f7b2ed19c3c" style="width:400px;height:350px;" class="plotly html-widget "></div>
<script type="application/json" data-for="htmlwidget-f747bf3b0f7b2ed19c3c">{"x":{"data":[{"x":[-2.5758293035488999,-2.1700903775845601,-1.9599639845400538,-1.8119106729525978,-1.6953977102721358,-1.5981931399228173,-1.5141018876192833,-1.4395314709384557,-1.3722038089987258,-1.3105791121681289,-1.2535654384704509,-1.2003588580308591,-1.1503493803760079,-1.1030625561995975,-1.058121617684777,-1.0152220332170281,-0.97411387705930896,-0.93458929107348021,-0.89647336400191624,-0.85961736424191137,-0.82389363033855756,-0.78919165265822233,-0.75541502636046931,-0.72247905192806272,-0.69030882393303405,-0.65883769273618786,-0.62800601443756965,-0.59776012604247841,-0.56805149833898294,-0.53883603027845028,-0.51007345696859474,-0.48172684958473022,-0.45376219016987929,-0.4261480078412781,-0.39885506564233686,-0.3718560893850747,-0.34512553147047226,-0.31863936396437514,-0.29237489622680418,-0.26631061320409494,-0.24042603114230793,-0.21470156800174453,-0.18911842627279249,-0.16365848623314122,-0.1383042079614045,-0.11303854064456507,-0.087844837895871677,-0.062706777943213832,-0.037608287661255936,-0.012533469508069278,0.012533469508069278,0.037608287661255936,0.062706777943213832,0.087844837895871816,0.11303854064456521,0.13830420796140463,0.16365848623314108,0.18911842627279238,0.21470156800174439,0.24042603114230793,0.26631061320409494,0.29237489622680418,0.31863936396437514,0.34512553147047226,0.3718560893850747,0.39885506564233686,0.42614800784127826,0.45376219016987962,0.48172684958473033,0.51007345696859452,0.53883603027845017,0.56805149833898272,0.59776012604247841,0.62800601443756965,0.65883769273618786,0.69030882393303405,0.72247905192806272,0.75541502636046931,0.78919165265822233,0.82389363033855756,0.85961736424191171,0.89647336400191591,0.93458929107347977,0.97411387705930896,1.0152220332170281,1.058121617684777,1.1030625561995975,1.1503493803760079,1.2003588580308591,1.2535654384704509,1.3105791121681289,1.3722038089987263,1.4395314709384559,1.514101887619284,1.5981931399228169,1.6953977102721358,1.8119106729525971,1.9599639845400536,2.1700903775845601,2.5758293035488999],"y":[-1.2016916955435366,-1.1828359431539979,-1.1486162555740229,-1.1405033951491306,-1.1043868221486766,-1.0325279818884947,-1.0279323131432641,-1.023169102184309,-0.97673317125232051,-0.92229535101143845,-0.91611014185444317,-0.90825204766987233,-0.89434509918275351,-0.89221313670227109,-0.89036957667485084,-0.84847955071011349,-0.82961687146398566,-0.80778853024786135,-0.80719595096637453,-0.80657624566583452,-0.80630760389127254,-0.79626388306757945,-0.76807364778833054,-0.75671612859281279,-0.74090226777172019,-0.73120633845860272,-0.72846566508762889,-0.68144396100671001,-0.67654820207931432,-0.66668003426271516,-0.660177016554924,-0.64973192503540067,-0.58529411046012336,-0.5848266620614847,-0.58391935830870689,-0.58250426451545423,-0.5570896264724633,-0.54508840848456652,-0.4823330247059251,-0.46531657304421015,-0.44026346571207159,-0.4388467683800627,-0.43490018748394271,-0.41725543022733569,-0.40851569057315429,-0.40306725242968278,-0.40054965125510034,-0.38940962194143369,-0.37697722705760406,-0.36480470584164437,-0.32562345035445117,-0.2880123032430526,-0.28161219124386533,-0.26170446450414525,-0.2089162129325689,-0.17653990166274516,-0.081725957553862957,-0.066255586866435928,-0.02539545809266033,0.0055965915389810253,0.0065121170876483196,0.059728484278006658,0.079256519090166594,0.096455828791540479,0.13406518931589065,0.17245425745420132,0.18098226458359309,0.26185036404595524,0.26690163188166471,0.26945361351091335,0.29995636754433419,0.3457615712039559,0.37791418350366923,0.38850257808632205,0.39562596571837938,0.39730481345054824,0.43095853551886043,0.45320496366516461,0.53134528120821967,0.58024097219871973,0.67098814969986142,0.72263595274634917,0.8466815053684732,0.90125456323291175,0.92667232146071088,0.93736275832847338,0.95700006363667101,1.0212323102268648,1.0338038997007131,1.2217341772665018,1.3025906075709339,1.7491797124325725,1.7565187555460287,2.0863360703017353,2.1328691345169486,2.3574510489134517,2.5994041108985382,2.732336066326611,2.7490909451828611,null],"text":["Quantile: 0.01","Quantile: 0.02","Quantile: 0.03","Quantile: 0.04","Quantile: 0.05","Quantile: 0.059","Quantile: 0.069","Quantile: 0.079","Quantile: 0.089","Quantile: 0.099","Quantile: 0.109","Quantile: 0.119","Quantile: 0.129","Quantile: 0.139","Quantile: 0.149","Quantile: 0.158","Quantile: 0.168","Quantile: 0.178","Quantile: 0.188","Quantile: 0.198","Quantile: 0.208","Quantile: 0.218","Quantile: 0.228","Quantile: 0.238","Quantile: 0.248","Quantile: 0.257","Quantile: 0.267","Quantile: 0.277","Quantile: 0.287","Quantile: 0.297","Quantile: 0.307","Quantile: 0.317","Quantile: 0.327","Quantile: 0.337","Quantile: 0.347","Quantile: 0.356","Quantile: 0.366","Quantile: 0.376","Quantile: 0.386","Quantile: 0.396","Quantile: 0.406","Quantile: 0.416","Quantile: 0.426","Quantile: 0.436","Quantile: 0.446","Quantile: 0.455","Quantile: 0.465","Quantile: 0.475","Quantile: 0.485","Quantile: 0.495","Quantile: 0.505","Quantile: 0.515","Quantile: 0.525","Quantile: 0.535","Quantile: 0.545","Quantile: 0.554","Quantile: 0.564","Quantile: 0.574","Quantile: 0.584","Quantile: 0.594","Quantile: 0.604","Quantile: 0.614","Quantile: 0.624","Quantile: 0.634","Quantile: 0.644","Quantile: 0.653","Quantile: 0.663","Quantile: 0.673","Quantile: 0.683","Quantile: 0.693","Quantile: 0.703","Quantile: 0.713","Quantile: 0.723","Quantile: 0.733","Quantile: 0.743","Quantile: 0.752","Quantile: 0.762","Quantile: 0.772","Quantile: 0.782","Quantile: 0.792","Quantile: 0.802","Quantile: 0.812","Quantile: 0.822","Quantile: 0.832","Quantile: 0.842","Quantile: 0.851","Quantile: 0.861","Quantile: 0.871","Quantile: 0.881","Quantile: 0.891","Quantile: 0.901","Quantile: 0.911","Quantile: 0.921","Quantile: 0.931","Quantile: 0.941","Quantile: 0.95","Quantile: 0.96","Quantile: 0.97","Quantile: 0.98","Quantile: 0.99"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(67,65,138,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(67,65,138,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-3.2999999999999998,3.2999999999999998],"y":[-3.2999999999999998,3.2999999999999998],"text":"intercept: 0<br />slope: 1","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(255,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":24.349641226353555,"r":7.3059360730593621,"b":38.303979125896944,"l":37.260273972602747},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-3.2999999999999998,3.2999999999999998],"tickmode":"array","ticktext":["-2","0","2"],"tickvals":[-2,0,2],"categoryorder":"array","categoryarray":["-2","0","2"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"theoretical","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"scaleanchor":"y","scaleratio":1,"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-3.2999999999999998,3.2999999999999998],"tickmode":"array","ticktext":["-2","0","2"],"tickvals":[-2,0,2],"categoryorder":"array","categoryarray":["-2","0","2"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"sample","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"scaleanchor":"x","scaleratio":1,"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498}},"hovermode":"closest","width":400,"height":350,"barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"40bc672925a3":{"sample":{},"type":"scatter"},"40bc67f6252b":{"intercept":{},"slope":{}}},"cur_data":"40bc672925a3","visdat":{"40bc672925a3":["function (y) ","x"],"40bc67f6252b":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
]


---
### Q-Q plot

&lt;img src="C_4_slides_a_files/figure-html/unnamed-chunk-21-1.png" width="100%" /&gt;


---
### Jarque-Bera Test

- We can also use the **Jarque-Bera Test** to see whether sample comes from a normal distribution

**Intuition**
- Skeweness of normal distribution is 0 (it's symmetric)

`$$S = \frac{\frac{1}{n} \sum_{i=1}^{n}(x_i - \bar{x})^3}{\left(\frac{1}{n} \sum_{i=1}^{n}(x_i - \bar{x})^2\right)^{\frac{3}{2}}}$$`

---


&lt;img src="C_4_slides_a_files/figure-html/unnamed-chunk-22-1.png" width="100%" /&gt;

---
### Jarque-Bera Test

- We can also use the **Jarque-Bera Test** to see whether sample comes from a normal distribution

**Intuition**
- Skeweness of normal distribution is 0 (it's symmetric)

`$$S = \frac{\frac{1}{n} \sum_{i=1}^{n}(x_i - \bar{x})^3}{\left(\frac{1}{n} \sum_{i=1}^{n}(x_i - \bar{x})^2\right)^{\frac{3}{2}}}$$`


- Kurtosis of normal distribution is 3 
- Excess kurtosis is 0

`$$EK = \frac{\frac{1}{n} \sum_{i=1}^{n}(x_i - \bar{x})^4}{\left(\frac{1}{n} \sum_{i=1}^{n}(x_i - \bar{x})^2\right)^{2}} - 3$$`


---


&lt;img src="C_4_slides_a_files/figure-html/unnamed-chunk-23-1.png" width="100%" /&gt;


---
### Jarque-Bera Test

- We can also use the **Jarque-Bera Test** to see whether sample comes from a normal distribution

**Intuition**
- Skeweness of normal distribution is 0 (it's symmetric)

`$$S = \frac{\frac{1}{n} \sum_{i=1}^{n}(x_i - \bar{x})^3}{\left(\frac{1}{n} \sum_{i=1}^{n}(x_i - \bar{x})^2\right)^{\frac{3}{2}}}$$`


- Kurtosis of normal distribution is 3 
- Excess kurtosis is 0

`$$EK = \frac{\frac{1}{n} \sum_{i=1}^{n}(x_i - \bar{x})^4}{\left(\frac{1}{n} \sum_{i=1}^{n}(x_i - \bar{x})^2\right)^{2}} - 3$$`


- We will test, whether our sample has (more or less)
  - Skewenss of 0
  - Kurtosis of 3

---
### Jarque-Bera Test


The test statistic for our test is:

`$$JB = \frac{n}{6} \left(\frac{S^2}{2} + \frac{EK^2}{4}\right)$$`

- Its value will be high if:
  - Skeweness deviates significantly from 0
  - Kurtosis deviates significantly from 3

--

- If the data really comes from normal (that's our null hypothesis), then:

`$$JB \sim  \chi_2$$`
- It follows the Chi-squared distribution with 2 degrees of freedom. 

---
### Jarque-Bera Test

So in our usual testing setting:

- `\(H_0: e_i\)` comes from normal (JB is small)
- `\(H_A: e_i\)` Does not come from normal (JB is large)

- It's a one sided test, so we reject at `\(\alpha\)` if 

`$$JB_{test}&gt;\chi_{1-\alpha,2}$$`
---
### Jarque-Bera Test

&lt;img src="C_4_slides_a_files/figure-html/unnamed-chunk-24-1.png" width="100%" /&gt;


```r
library(tseries)
jarque.bera.test(sample_data)
```

```
## 
## 	Jarque Bera Test
## 
## data:  sample_data
## X-squared = 0.96619, df = 2, p-value = 0.6169
```

---
### Jarque-Bera Test

&lt;img src="C_4_slides_a_files/figure-html/unnamed-chunk-26-1.png" width="100%" /&gt;


```r
library(tseries)
jarque.bera.test(sample_data)
```

```
## 
## 	Jarque Bera Test
## 
## data:  sample_data
## X-squared = 420.19, df = 2, p-value &lt; 2.2e-16
```

---
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"countIncrementalSlides": true
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
