theme_minimal() +
xlim(-3, 3) +
ylim(-3, 3)  # Set y-axis limits to show cumulative probability
qq_plot=ggplotly(qq_plot,
width = 400,   # Adjust the width according to your preference
height = 500)
data_df$Index <- rank(data_df$Residuals)
data_df$Cumulative_Probability <- round(data_df$Index / (nrow(data_df) + 1),3)
data_df <- data_df[order(data_df$Residuals), ]
qq_plot$x$data[[1]]$text <- paste("Quantile:", data_df$Cumulative_Probability)
qq_plot
qq_plot
xaringan::inf_mr()
set.seed(123)
# Generate a sample of 100 values from a normal distribution with mean 0 and standard deviation 1
sample_data <- rnorm(100, mean = 0, sd = 1)
# Create a histogram of the sample
hist(sample_data, main = "Histogram of Normal Distribution Sample", xlab = "Values", ylab = "Frequency")
# Calculate the Jarque-Bera statistic
library(moments)
install.packages(moments)
install.packages("moments")
# Create a histogram of the sample
hist(sample_data, main = "Histogram of Normal Distribution Sample", xlab = "Values", ylab = "Frequency")
# Calculate the Jarque-Bera statistic
library(moments)
jarque.bera.test(sample_data)
install.packages("tseries")
install.packages("tseries")
# Calculate the Jarque-Bera statistic
library(tseries)
jarque.bera.test(sample_data)
# Create a histogram using ggplot2
ggplot(data = data.frame(x = sample_data), aes(x = x)) +
geom_histogram(binwidth = 0.5) +
labs(title = "Histogram of Normal Distribution Sample",
x = "Values",
y = "Frequency")+
theme_xaringan()
# Calculate the Jarque-Bera statistic
library(tseries)
jarque.bera.test(sample_data)
library(renderthis)
remotes::install_github('rstudio/chromote')
to_pdf("C_4_slides_b.html")
to_pdf("C_4_slides_c.html")
to_pdf("C_4_slides_a.html")
library(renderthis)
remotes::install_github('rstudio/chromote')
to_pdf("C_4_slides_a.html")
library(probstats4econ)
lm(famincome ~ age_h, data = married)
binsreg(married$famincome, married$age_h, nbins = 20)
library(binsreg)
binsreg(married$famincome, married$age_h, nbins = 20)
binsreg(births$bweight, married$age, nbins = 20)
binsreg(births$bweight, births$age, nbins = 20)
binsreg(births$bweight, births$age)
births
binsreg(births$bmi_h, married$age_h, nbins = 20)
binsreg(married$bmi_h, married$age_h)
binsreg(married$bmi_h, married$famincome)
binsreg(cigdata$cigsales, cigdata$cigprice)
plot(cigdata$cigsales, cigdata$cigprice)
cigdata
r1=lm(cigsales ~ cigtax, data = cigdata)
plot(cigdata$cigsales, cigdata$cigtax)
plot(cigdata$cigtax, cigdata$cigsales)
plot(cigdata$cigprice, cigdata$cigsales)
plot(cigdata$cig_tax_revenue, cigdata$cigsales)
plot(cigdata$cig_tax_revenue, cigdata$cigtax)
plot(cigdata$cig_tax_revenue, log(cigdata$cigtax))
plot(cigdata$cig_tax_revenue, cigdata$cigtax)
plot(cigdata$cigtax,cigdata$cig_tax_revenue)
plot(cigdata$cigprice,cigdata$cig_tax_revenue)
plot(houseprice$lotarea, cigdata$saleprice))
plot(houseprice$lotarea, cigdata$saleprice)
plot(houseprices$lotarea, cigdata$saleprice)
plot(houseprices$lotarea, houseprices$saleprice)
plot(houseprices$lotarea, log(houseprices$saleprice))
plot(houseprices$lotarea, houseprices$saleprice)
r1=lm(saleprice ~ lotarea, data = houseprices[houseprices$lotarea<50000])
r1=lm(saleprice ~ lotarea, data = houseprices[houseprices$lotarea<50000,])
houseprices=houseprices[houseprices$lotarea<50000,] #eliminate outliers
r1=lm(saleprice ~ lotarea, data = houseprices[houseprices$lotarea<50000,])
fitted_values_linear <- r1$fitted.values
residuals_linear <- r1$residuals
plot)(fitted_values_linear, residuals_linear,
plot(fitted_values_linear, residuals_linear,
xlab = "Fitted Values",
ylab = "Residuals",
main = "Residuals vs Fitted Values")
plot(houseprices$lotarea, houseprices$sales)
plot(houseprices$lotarea, houseprices$saleprce)
plot(houseprices$lotarea, houseprices$saleprice)
houseprices=houseprices[houseprices$lotarea,] #eliminate outliers
plot(houseprices$lotarea, houseprices$saleprice)
plot(houseprices$lotarea, houseprices$saleprice)
r1=lm(saleprice ~ lotarea, data = houseprices)
houseprices=houseprices[houseprices$lotarea<50000,] #eliminate outliers
plot(houseprices$lotarea, houseprices$saleprice)
plot(houseprices$lotarea, houseprices$saleprice)
r1=lm(saleprice ~ lotarea, data = houseprices)
houseprices
library(probstats4econ)
houseprices=houseprices[houseprices$lotarea<50000,] #eliminate outliers
houseprices
plot(fitted_values_linear, residuals_linear)
# Fit linear regression
r1 <- lm(saleprice ~ lotarea, data = houseprices)
fitted_values_linear <- r1$fitted.values
residuals_linear <- r1$residuals
load("C:/Users/kzysi/Dropbox/Mexico_Sex_Ratio/Data/birth_sex_ratio.Rda")
birth_sex_ratio
birth_sex_ratio[sample(1:9960), size=200]
n=birth_sex_ratio[sample(1:9960), size=200]
View(n)
n=n[n$Cohort=="2000-2004"]
n=n[n$Cohort=="2000-2004",]
View(n)
n=birth_sex_ratio[sample(1:9960), size=200]
n=birth_sex_ratio[sample(1:9960), 00]
n=birth_sex_ratio[sample(1:9960, 200),]
n=n[n$Cohort=="2000-2004",]
n=birth_sex_ratio[sample(1:9960, 500),]
n=n[n$Cohort=="2000-2004",]
View(n)
sexratios= mydata <- read.table(text="
1 31047 2000-2004 218 232 450 0.5155556
2 15054 2000-2004 10659 10917 21576 0.5059789
3 24050 2000-2004 3043 3219 6262 0.5140530
4 26008 2000-2004 58 67 125 0.5360000
5 29033 2000-2004 3617 3715 7332 0.5066830
6 22007 2000-2004 2040 2092 4132 0.5062924
7 07044 2000-2004 1497 1616 3113 0.5191134
8 31091 2000-2004 630 668 1298 0.5146379
9 16100 2000-2004 728 744 1472 0.5054348
10 10033 2000-2004 351 340 691 0.4920405
11 30191 2000-2004 1178 1276 2454 0.5199674
12 16057 2000-2004 483 540 1023 0.5278592
13 20094 2000-2004 107 99 206 0.4805825
14 24052 2000-2004 468 444 912 0.4868421
15 29048 2000-2004 967 1057 2024 0.5222332
16 20190 2000-2004 1297 1284 2581 0.4974816
17 28030 2000-2004 673 711 1384 0.5137283
18 07060 2000-2004 1041 1052 2093 0.5026278
19 30132 2000-2004 1104 1178 2282 0.5162138
20 20035 2000-2004 27 42 69 0.6086957
21 30070 2000-2004 994 1093 2087 0.5237183
22 15027 2000-2004 448 403 851 0.4735605
23 20203 2000-2004 262 279 541 0.5157116
24 20195 2000-2004 95 105 200 0.5250000
25 32042 2000-2004 3396 3530 6926 0.5096737
26 24001 2000-2004 1239 1312 2551 0.5143081
27 20291 2000-2004 271 312 583 0.5351630
28 15110 2000-2004 3484 3740 7224 0.5177187
29 31060 2000-2004 49 73 122 0.5983607
30 01007 2000-2004 2892 2964 5856 0.5061475
31 21033 2000-2004 253 239 492 0.4857724
32 07034 2000-2004 3607 3618 7225 0.5007612
33 17006 2000-2004 7982 8547 16529 0.5170912
34 26050 2000-2004 43 59 102 0.5784314
35 20099 2000-2004 27 34 61 0.5573770
36 30094 2000-2004 1781 1778 3559 0.4995785
37 21191 2000-2004 532 527 1059 0.4976393
38 14097 2000-2004 8904 9531 18435 0.5170057
39 30131 2000-2004 8351 8941 17292 0.5170599
40 09007 2000-2004 81971 85183 167154 0.5096079
41 13045 2000-2004 500 543 1043 0.5206136
42 20350 2000-2004 589 645 1234 0.5226904
43 07091 2000-2004 719 703 1422 0.4943741
44 11030 2000-2004 6822 7058 13880 0.5085014
45 20134 2000-2004 2017 2045 4062 0.5034466
46 15087 2000-2004 6417 6651 13068 0.5089532
47 21198 2000-2004 76 87 163 0.5337423
48 21187 2000-2004 366 362 728 0.4972527
49 07037 2000-2004 1853 1920 3773 0.5088789
50 14115 2000-2004 332 326 658 0.4954407
51 20391 2000-2004 251 287 538 0.5334572
52 20417 2000-2004 523 549 1072 0.5121269
53 12076 2000-2004 2659 2711 5370 0.5048417
54 32038 2000-2004 4261 4410 8671 0.5085919
55 32014 2000-2004 1238 1272 2510 0.5067729
56 20431 2000-2004 95 108 203 0.5320197
57 21125 2000-2004 488 468 956 0.4895397
58 20356 2000-2004 75 89 164 0.5426829
59 12059 2000-2004 1727 1888 3615 0.5222683
60 21183 2000-2004 1394 1414 2808 0.5035613
61 08018 2000-2004 489 484 973 0.4974306
62 20236 2000-2004 143 120 263 0.4562738
63 05020 2000-2004 3845 3989 7834 0.5091907
64 20511 2000-2004 256 242 498 0.4859438
65 24003 2000-2004 3730 3758 7488 0.5018697
66 30113 2000-2004 316 329 645 0.5100775
67 20145 2000-2004 77 82 159 0.5157233
68 11022 2000-2004 1391 1451 2842 0.5105559
69 30168 2000-2004 1088 1040 2128 0.4887218
70 29055 2000-2004 144 184 328 0.5609756
71 31004 2000-2004 287 282 569 0.4956063
72 21145 2000-2004 957 1040 1997 0.5207812
73 20418 2000-2004 566 624 1190 0.5243697
74 05029 2000-2004 114 123 237 0.5189873
75 15102 2000-2004 1009 941 1950 0.4825641
76 19039 2000-2004 64123 66782 130905 0.5101562
77 21202 2000-2004 972 998 1970 0.5065990
78 13073 2000-2004 2199 2397 4596 0.5215405
79 17022 2000-2004 1122 1106 2228 0.4964093
80 31045 2000-2004 116 119 235 0.5063830
81 20390 2000-2004 2498 2566 5064 0.5067141
82 24031 2000-2004 899 911 1810 0.5033149
83 14117 2000-2004 303 319 622 0.5128617
84 20474 2000-2004 126 159 285 0.5578947
85 20465 2000-2004 115 130 245 0.5306122
86 30138 2000-2004 2051 2034 4085 0.4979192
87 20008 2000-2004 20 42 62 0.6774194
88 31017 2000-2004 270 275 545 0.5045872
89 13014 2000-2004 1075 1130 2205 0.5124717
90 26056 2000-2004 507 575 1082 0.5314233
91 21104 2000-2004 1712 1765 3477 0.5076215
92 20382 2000-2004 55 66 121 0.5454545
93 30028 2000-2004 6529 6821 13350 0.5109363
94 19035 2000-2004 31 34 65 0.5230769
95 10012 2000-2004 7900 8282 16182 0.5118032
96 20557 2000-2004 765 719 1484 0.4845013
97 24051 2000-2004 824 804 1628 0.4938575
98 20455 2000-2004 163 183 346 0.5289017
99 21084 2000-2004 539 474 1013 0.4679171
100 30192 2000-2004 904 899 1803 0.4986134
101 08049 2000-2004 169 178 347 0.5129683
102 21003 2000-2004 2039 2002 4041 0.4954219
103 12071 2000-2004 1981 1924 3905 0.4927017
104 25001 2000-2004 20388 21387 41775 0.5119569
105 08041 2000-2004 110 100 210 0.4761905
106 30018 2000-2004 127 152 279 0.5448029
107 21109 2000-2004 1356 1397 2753 0.5074464
108 14028 2000-2004 97 98 195 0.5025641
109 04002 2000-2004 11224 11173 22397 0.4988615
110 20514 2000-2004 63 56 119 0.4705882
111 27002 2000-2004 14567 15181 29748 0.5103200
112 20335 2000-2004 78 72 150 0.4800000
113 20196 2000-2004 18 19 37 0.5135135
114 21082 2000-2004 507 459 966 0.4751553
115 20468 2000-2004 953 985 1938 0.5082559
116 08006 2000-2004 295 284 579 0.4905009
117 19026 2000-2004 37657 39277 76934 0.5105285
118 31046 2000-2004 145 144 289 0.4982699
119 13019 2000-2004 860 951 1811 0.5251242
120 10011 2000-2004 236 208 444 0.4684685
121 20295 2000-2004 439 473 912 0.5186404
122 20406 2000-2004 1522 1476 2998 0.4923282
123 12023 2000-2004 1429 1517 2946 0.5149355
124 15003 2000-2004 2829 2899 5728 0.5061103
125 20239 2000-2004 35 59 94 0.6276596
126 08014 2000-2004 106 96 202 0.4752475
", header=FALSE)
colnames(sexratios) <- c("id","fips","period","male","female","total","share_male")
m1 <- lm(share_male ~ total, data = sexratios)
summary(m1)
# Residuals vs fitted values to check homoskedasticity
plot(fitted(m1), resid(m1),
xlab = "Fitted Values",
ylab = "Residuals",
main = "Residual Plot: Checking Homoskedasticity")
# Residuals vs fitted values to check homoskedasticity
plot(fitted(m1), resid(m1))
# Residuals vs fitted values to check homoskedasticity
plot(fitted(m1), sexratios$total)
# Residuals vs fitted values to check homoskedasticity
plot(sexratios$total, resid(m1))
# Residuals vs fitted values to check homoskedasticity
plot(hrs$age, hrs$medical_costs)
# Residuals vs fitted values to check homoskedasticity
plot(hrs$income, hrs$medical_costs)
# Residuals vs fitted values to check homoskedasticity
plot(hrs$doctor_visits, hrs$medical_costs)
# Residuals vs fitted values to check homoskedasticity
plot(mutualfunds$aum)
# Residuals vs fitted values to check homoskedasticity
plot(mutualfunds$aum, mutualfunds$return_1yr)
# Residuals vs fitted values to check homoskedasticity
plot(mutualfunds$aum, mutualfunds$return_2yr)
# Residuals vs fitted values to check homoskedasticity
plot(mutualfunds$aum, mutualfunds$return_3yr)
# Residuals vs fitted values to check homoskedasticity
plot(mutualfunds$aum, mutualfunds$return_5yr)
m1 <- lm(return_5yr ~ total, data = sexratios)
m1 <- lm(return_1yr ~ total, data = mutualfunds)
m1 <- lm(return_1yr ~ aum, data = mutualfunds)
summary(m1)
m1 <- lm(inflation_pred ~ age, data = inflation_expectations)
summary(m1)
m1 <- lm(inflation_pred ~ finlit_score, data = inflation_expectations)
summary(m1)
# Residuals vs fitted values to check homoskedasticity
plot(inflation_expectations$finlit_score, inflation_expectations$inflation_pred)
load("C:/Users/kzysi/Dropbox/Mexico_Sex_Ratio/Data/census_sex_ratio.Rda")
View(population_mex_Wide)
subset1=population_mex_Wide%>%filter(Cohort=="2000-2004" & year="2020")
subset1=population_mex_Wide%>%filter(Cohort=="2000-2004" & year=="2020")
tidyverse
library(tidyverse)
subset1=population_mex_Wide%>%filter(Cohort=="2000-2004" & year=="2020")
subset1=subset1[sample(1:2469,100),]
View(subset1)
sexratios <- read.table(text="
21163 2000-2004 2020 985 901 0.4777306 1886
08063 2000-2004 2020 190 175 0.4794521 365
20544 2000-2004 2020 23 22 0.4888889 45
14080 2000-2004 2020 167 189 0.5308989 356
19039 2000-2004 2020 45696 46977 0.5069114 92673
14017 2000-2004 2020 494 520 0.5128205 1014
28023 2000-2004 2020 137 142 0.5089606 279
20462 2000-2004 2020 173 203 0.5398936 376
20359 2000-2004 2020 16 19 0.5428571 35
07023 2000-2004 2020 5775 4946 0.4613376 10721
24004 2000-2004 2020 176 146 0.4534161 322
28026 2000-2004 2020 127 165 0.5650685 292
07099 2000-2004 2020 3796 3549 0.4831858 7345
21029 2000-2004 2020 184 172 0.4831461 356
11025 2000-2004 2020 4050 4158 0.5065789 8208
21083 2000-2004 2020 1160 1090 0.4844444 2250
07018 2000-2004 2020 478 468 0.4947146 946
26016 2000-2004 2020 201 197 0.4949749 398
16088 2000-2004 2020 5310 5306 0.4998116 10616
20135 2000-2004 2020 372 333 0.4723404 705
14035 2000-2004 2020 2200 2287 0.5096947 4487
05009 2000-2004 2020 2690 2698 0.5007424 5388
10005 2000-2004 2020 30545 30975 0.5034948 61520
17023 2000-2004 2020 338 388 0.5344353 726
20375 2000-2004 2020 614 587 0.4887594 1201
11001 2000-2004 2020 4245 4254 0.5005295 8499
26020 2000-2004 2020 198 224 0.5308057 422
29037 2000-2004 2020 453 443 0.4944196 896
31024 2000-2004 2020 153 151 0.4967105 304
32009 2000-2004 2020 379 395 0.5103359 774
12079 2000-2004 2020 1078 1050 0.4934211 2128
20041 2000-2004 2020 1257 1117 0.4705139 2374
30020 2000-2004 2020 697 640 0.4786836 1337
13083 2000-2004 2020 2435 2501 0.5066856 4936
20107 2000-2004 2020 1223 1164 0.4876414 2387
31064 2000-2004 2020 67 50 0.4273504 117
30207 2000-2004 2020 1825 1838 0.5017745 3663
12061 2000-2004 2020 1902 2019 0.5149197 3921
11019 2000-2004 2020 2155 2057 0.4883666 4212
31079 2000-2004 2020 2158 2107 0.4940211 4265
16064 2000-2004 2020 1218 1195 0.4952341 2413
10003 2000-2004 2020 165 182 0.5244957 347
21124 2000-2004 2020 716 779 0.5210702 1495
20492 2000-2004 2020 78 92 0.5411765 170
07076 2000-2004 2020 1523 1519 0.4993425 3042
20103 2000-2004 2020 262 240 0.4780876 502
17003 2000-2004 2020 1678 1644 0.4948826 3322
31057 2000-2004 2020 345 341 0.4970845 686
20222 2000-2004 2020 39 58 0.5979381 97
20006 2000-2004 2020 913 837 0.4782857 1750
20551 2000-2004 2020 1235 1171 0.4866999 2406
30111 2000-2004 2020 676 634 0.4839695 1310
31093 2000-2004 2020 749 795 0.5148964 1544
12002 2000-2004 2020 1296 1155 0.4712362 2451
05011 2000-2004 2020 485 465 0.4894737 950
20303 2000-2004 2020 25 34 0.5762712 59
20076 2000-2004 2020 169 152 0.4735202 321
09005 2000-2004 2020 42664 44622 0.5112160 87286
20196 2000-2004 2020 6 14 0.7000000 20
27001 2000-2004 2020 2491 2506 0.5015009 4997
14067 2000-2004 2020 12524 12616 0.5018298 25140
20085 2000-2004 2020 1367 1376 0.5016405 2743
16006 2000-2004 2020 5535 5524 0.4995027 11059
14051 2000-2004 2020 1298 1254 0.4913793 2552
20240 2000-2004 2020 149 137 0.4790210 286
21192 2000-2004 2020 240 238 0.4979079 478
21032 2000-2004 2020 32 50 0.6097561 82
31104 2000-2004 2020 801 854 0.5160121 1655
14021 2000-2004 2020 796 802 0.5018773 1598
31086 2000-2004 2020 87 83 0.4882353 170
32017 2000-2004 2020 9793 9711 0.4978979 19504
07005 2000-2004 2020 1281 1230 0.4898447 2511
04001 2000-2004 2020 2426 2584 0.5157685 5010
23004 2000-2004 2020 9936 10122 0.5046366 20058
28043 2000-2004 2020 875 856 0.4945118 1731
20550 2000-2004 2020 209 228 0.5217391 437
20478 2000-2004 2020 41 44 0.5176471 85
30057 2000-2004 2020 702 686 0.4942363 1388
12035 2000-2004 2020 6669 6614 0.4979297 13283
20105 2000-2004 2020 337 292 0.4642289 629
20552 2000-2004 2020 14 17 0.5483871 31
20158 2000-2004 2020 100 117 0.5391705 217
20355 2000-2004 2020 27 21 0.4375000 48
14015 2000-2004 2020 2759 2826 0.5059982 5585
21087 2000-2004 2020 560 585 0.5109170 1145
07020 2000-2004 2020 2260 2304 0.5048203 4564
07052 2000-2004 2020 7785 7289 0.4835478 15074
16087 2000-2004 2020 642 626 0.4936909 1268
08039 2000-2004 2020 157 165 0.5124224 322
25018 2000-2004 2020 6806 7106 0.5107821 13912
26037 2000-2004 2020 30 37 0.5522388 67
12053 2000-2004 2020 2268 2264 0.4995587 4532
14059 2000-2004 2020 607 594 0.4945878 1201
20412 2000-2004 2020 145 123 0.4589552 268
30037 2000-2004 2020 410 384 0.4836272 794
32002 2000-2004 2020 213 191 0.4727723 404
20278 2000-2004 2020 1515 1579 0.5103426 3094
05013 2000-2004 2020 75 89 0.5426829 164
17018 2000-2004 2020 5461 5326 0.4937425 10787
19038 2000-2004 2020 2973 3079 0.5087574 6052
", header=FALSE)
colnames(sexratios) <- c("fips","period","year","male","female","share_male","total")
# Residuals vs fitted values to check homoskedasticity
plot(sexratios$share_male, sexratios$total)
# Residuals vs fitted values to check homoskedasticity
plot(sexratios$total,sexratios$share_male)
m1 <- lm(share_male ~ total, data = sexratios)
summary(m1)
# Residuals vs fitted values to check homoskedasticity
fitted_values_linear <- m1$fitted.values
residuals_linear <- m1$residuals
# Residual plot
plot(fitted_values_linear, residuals_linear)
plot(sexratios$total,sexratios$share_male)
m1 <- lm(share_male ~ total, data = sexratios)
summary(m1)
# Residuals vs fitted values to check homoskedasticity
fitted_values_linear <- m1$fitted.values
residuals_linear <- m1$residuals
# Residual plot
plot(fitted_values_linear, residuals_linear)
plot(sexratios$total,sexratios$share_male)
plot(mutualfunds$fund_age,mutualfunds$return_1yr)
m1 <- lm(return_1yr ~ fund_age, data = mutualfunds)
summary(m1)
m1 <- lm(return_1yr ~ manager_tenure, data = mutualfunds)
summary(m1)
m1 <- lm(return_1yr ~ aum, data = mutualfunds)
summary(m1)
m1 <- lm(return_1yr ~ expense_ratio, data = mutualfunds)
summary(m1)
m1 <- lm(return_5yr ~ expense_ratio, data = mutualfunds)
summary(m1)
m1 <- lm(return_5yr ~ aum, data = mutualfunds)
summary(m1)
m1 <- lm(return_5yr ~ fund_age, data = mutualfunds)
summary(m1)
m1 <- lm(return_5yr ~manager_tenure, data = mutualfunds)
summary(m1)
m1 <- lm(return_3yr ~ manager_tenure, data = mutualfunds)
summary(m1)
m1 <- lm(return_5yr ~ min_investment, data = mutualfunds)
summary(m1)
m1 <- lm(return_5yr ~ expense_ratio, data = mutualfunds)
summary(m1)
hist(mutualfunds$expense_ratio)
m1 <- lm(return_10yr ~ expense_ratio, data = mutualfunds)
summary(m1)
m1 <- lm(return_3yr ~ expense_ratio, data = mutualfunds)
summary(m1)
m1 <- lm(return_5yr ~ expense_ratio, data = mutualfunds)
summary(m1)
resid=m1$residuals
# Histogram of residuals
```
# Histogram of residuals
hist(resid)
m1 <- lm(return_5yr ~ expense_ratio, data = mutualfunds)
summary(m1)
resid=m1$residuals
hist(mutualfunds$return_5yr)
m1 <- lm(return_5yr ~ expense_ratio, data = mutualfunds)
summary(m1)
resid=m1$residuals
ggplot(data_df) +
geom_qq(aes(sample = scale(Residuals))) +
geom_abline(color = "red") +
coord_fixed()
qqnorm(resid)
qqnorm(standarize(resid))
qqnorm(standardize(resid))
qqnorm(scale(resid))
qqline(res, col = "red", lwd = 2)
qqline(resid, col = "red", lwd = 2)
qqline(scale(resid), col = "red", lwd = 2)
qqnorm(scale(resid))
qqline(scale(resid), col = "red", lwd = 2)
jarque.bera.test(resid)
library(tseries)
jarque.bera.test(resid)
#calculate the skewness
S=1/n * sum((resid - mean(resid))^3)/ (sd(resid))^(3/2)
deviations=resid - mean(resid)
#calculate the skewness
S=(1/n * sum(deviations^3))/(1/n * sum(deviations^2))^(3/2)
deviations
#calculate the excess curtosis
EK=(1/n * sum(deviations^4))/(1/n * sum(deviations^2))^(2) - 3
(1/n * sum(deviations^4))
n=length(resid)
#calculate the skewness
S=(1/n * sum(deviations^3))/(1/n * sum(deviations^2))^(3/2)
#calculate the excess curtosis
EK=(1/n * sum(deviations^4))/(1/n * sum(deviations^2))^(2) - 3
#calculae the JB statistic
JB= n/6 * (S^2 + EK^2/4)
JB
jarque.bera.test(resid)
##compare to chi square with 2 degrees of freedom
p_value=1 - pchisq(JB, df=2)
p_value
pchisq(JB, df=2)
mutualfunds
m1 <- lm(return_5yr ~ fund_age, data = mutualfunds)
anova()
anova(m1)
cps$lfstatus
