Census1990$total_viviendas=as.numeric(as.character(Census1990$total_viviendas))
Census1990$total_viviendas_agua_entubada=as.numeric(as.character(Census1990$total_viviendas_agua_entubada))
Census1990$total_viviendas_electricity=as.numeric(as.character(Census1990$total_viviendas_electricity))
#calculate share economically active, share unemployed, share analfabetic, share indigenous, share with electricity, share with piped water
Census1990=Census1990%>%
mutate(econ_active=econ_act/(econ_act+econ_inact))%>%
mutate(unemployed=(econ_act-ocupada)/econ_act)%>%
mutate(Share_analf=pop_15_analf/(pop_15_analf+pop_15_alf))%>%
mutate(Share_indig=ind/(ind+no_ind))%>%
mutate(Share_electicity=total_viviendas_electricity/total_viviendas)%>%
mutate(Share_piped_water=total_viviendas_agua_entubada/total_viviendas)
#keep only total population plusthe characteristics above:
Census1990=Census1990%>%
select("CVE_ENT","CVE_MUN","CVE_LOC","Population","Share_analf","econ_active","unemployed","Share_indig","Share_electicity","Share_piped_water")
library(sf)
Highways=st_read("C:/Users/kzysi/Dropbox/Air pollution intergenerational effect/data/Shapefiles/Highways2000/carretera.shp")
ggplot(Highways)+geom_sf()
table(Highways$NO_CARRILE)
Highways=Highways%>%
filter(TIPO!="Terracería") ###only paved roads
##Federal Highways
Highways=Highways%>%
filter(ADMINISTRA=="Federal")
buffer_5km <- st_buffer(Highways, dist = 5000)
locations_sf <- st_as_sf(Locations, coords = c("Longitud", "Latitud"), crs = 4326)
locations_sf <- st_transform(locations_sf, crs = st_crs(Highways))
Locations$localities_within_5km <- lengths(st_within(locations_sf, buffer_5km))>0
Locations$LLAVE=paste0(Locations$CVE_ENT,Locations$CVE_MUN,Locations$CVE_LOC)
Locations_within_5=Locations%>%
filter(localities_within_5km==TRUE)
Census1990$LLAVE=paste0(Census1990$CVE_ENT,Census1990$CVE_MUN,Census1990$CVE_LOC)
Census1990=Census1990%>%
filter(LLAVE%in%Locations$LLAVE)%>%
mutate(Within_5km=LLAVE %in% Locations_within_5$LLAVE)
library(modelsummary)
datasummary_balance(~ Within_5km, data = Census1990, output="latex", stars=TRUE)
Census1990$CVE_ENT=NULL
Census1990$CVE_MUN=NULL
Census1990$CVE_LOC=NULL
Census1990$LLAVE=NULL
library(modelsummary)
datasummary_balance(~ Within_5km, data = Census1990, output="latex", stars=TRUE)
#multiply all except Population by 100
Census1990[,c("Share_analf","econ_active","unemployed","Share_indig","Share_electicity","Share_piped_water")]=Census1990[,c("Share_analf","econ_active","unemployed","Share_indig","Share_electicity","Share_piped_water")]*100
datasummary_balance(~ Within_5km, data = Census1990, output="latex", stars=TRUE)
names(Census1990)[10]=c("Population")
library(tidyverse)
library(sf)
Census1990<- read.delim("C:/Users/kzysi/Dropbox/Air pollution intergenerational effect/data/Census/1990/ITER_NALTXT90.txt", header=FALSE, comment.char="#")
names(Census1990)[1]=c("entidad")
names(Census1990)[3]=c("mun")
names(Census1990)[5]=c("loc")
Census1990$CVE_ENT=str_pad(Census1990$entidad, width = 2, side = "left", pad = "0")
Census1990$CVE_MUN=str_pad(Census1990$mun, width = 3, side = "left", pad = "0")
Census1990$CVE_LOC=str_pad(Census1990$loc, width = 4, side = "left", pad = "0")
Census1990=Census1990%>%
filter(CVE_LOC!="0000")%>%
filter(CVE_MUN!="000")
#number of localities
#population size
#share of population 15 who is analfabetic
#share of uemployed - 1-occupied/economically active
#share population which only speaks indigenous language
#share of household with electricity
#share of houesholds with piped water
names(Census1990)[10]=c("Population")
names(Census1990)[15]=c("pop_15_alf")
names(Census1990)[16]=c("pop_15_analf")
names(Census1990)[21]=c("no_ind")
names(Census1990)[22]=c("ind")
names(Census1990)[27]=c("econ_act")
names(Census1990)[28]=c("econ_inact")
names(Census1990)[29]=c("ocupada") #tasa de ocupacion: ese/econ_act
names(Census1990)[34]=c("total_viviendas")
names(Census1990)[43]=c("total_viviendas_agua_entubada")
names(Census1990)[45]=c("total_viviendas_electricity")
names(Census1990)[39]=c("scrap_materials")
names(Census1990)[19]=c("school614")
names(Census1990)[20]=c("noschool614")
names(Census1990)[30]=c("primary sector")
names(Census1990)[31]=c("secondary sector")
names(Census1990)[32]=c("tertiary sector")
#transform them to numeric
Census1990$Population=as.numeric(as.character(Census1990$Population))
Census1990$pop_15_alf=as.numeric(as.character(Census1990$pop_15_alf))
Census1990$pop_15_analf=as.numeric(as.character(Census1990$pop_15_analf))
Census1990$no_ind=as.numeric(as.character(Census1990$no_ind))
Census1990$ind=as.numeric(as.character(Census1990$ind))
Census1990$econ_act=as.numeric(as.character(Census1990$econ_act))
Census1990$econ_inact=as.numeric(as.character(Census1990$econ_inact))
Census1990$ocupada=as.numeric(as.character(Census1990$ocupada))
Census1990$total_viviendas=as.numeric(as.character(Census1990$total_viviendas))
Census1990$total_viviendas_agua_entubada=as.numeric(as.character(Census1990$total_viviendas_agua_entubada))
Census1990$total_viviendas_electricity=as.numeric(as.character(Census1990$total_viviendas_electricity))
Census1990$scrap_materials=as.numeric(as.character(Census1990$scrap_materials))
Census1990$school614=as.numeric(as.character(Census1990$school614))
Census1990$noschool614=as.numeric(as.character(Census1990$noschool614))
Census1990$`primary sector`=as.numeric(as.character(Census1990$`primary sector`))
Census1990$`secondary sector`=as.numeric(as.character(Census1990$`secondary sector`))
Census1990$`tertiary sector`=as.numeric(as.character(Census1990$`tertiary sector`))
#calculate share economically active, share unemployed, share analfabetic, share indigenous, share with electricity, share with piped water
Census1990=Census1990%>%
mutate(econ_active=econ_act/(econ_act+econ_inact))%>%
mutate(unemployed=(econ_act-ocupada)/econ_act)%>%
mutate(Share_analf=pop_15_analf/(pop_15_analf+pop_15_alf))%>%
mutate(Share_indig=ind/(ind+no_ind))%>%
mutate(Share_electicity=total_viviendas_electricity/total_viviendas)%>%
mutate(Share_piped_water=total_viviendas_agua_entubada/total_viviendas)
#calculate share economically active, share unemployed, share analfabetic, share indigenous, share with electricity, share with piped water
Census1990=Census1990%>%
mutate(econ_active=econ_act/(econ_act+econ_inact))%>%
mutate(unemployed=(econ_act-ocupada)/econ_act)%>%
mutate(Share_analf=pop_15_analf/(pop_15_analf+pop_15_alf))%>%
mutate(Share_indig=ind/(ind+no_ind))%>%
mutate(Share_electicity=total_viviendas_electricity/total_viviendas)%>%
mutate(Share_piped_water=total_viviendas_agua_entubada/total_viviendas)%>%
mutate(Share_scrap_materials=scrap_materials/total_viviendas)%>%
mutate(Share_at_school_614=noschool614/(school614+noschool614))%>%
mutate(Share_primary_sector=`primary sector`/ocupada)%>%
mutate(Share_secondary_sector=`secondary sector`/ocupada)%>%
mutate(Share_tertiary_sector=`tertiary sector`/ocupada)
#keep only total population plusthe characteristics above:
Census1990=Census1990%>%
select("CVE_ENT","CVE_MUN","CVE_LOC","Population","econ_active","unemployed","Share_primary_sector","Share_secondary_sector","Share_tertiary_sector",
"Share_analf","Share_indig","Share_electicity","Share_piped_water",
"Share_scrap_materials","Share_at_school_614",)
library(sf)
Highways=st_read("C:/Users/kzysi/Dropbox/Air pollution intergenerational effect/data/Shapefiles/Highways2000/carretera.shp")
ggplot(Highways)+geom_sf()
table(Highways$NO_CARRILE)
Highways=Highways%>%
filter(TIPO!="Terracería") ###only paved roads
##Federal Highways
Highways=Highways%>%
filter(ADMINISTRA=="Federal")
buffer_5km <- st_buffer(Highways, dist = 5000)
locations_sf <- st_as_sf(Locations, coords = c("Longitud", "Latitud"), crs = 4326)
locations_sf <- st_transform(locations_sf, crs = st_crs(Highways))
Locations$localities_within_5km <- lengths(st_within(locations_sf, buffer_5km))>0
Locations$LLAVE=paste0(Locations$CVE_ENT,Locations$CVE_MUN,Locations$CVE_LOC)
Locations_within_5=Locations%>%
filter(localities_within_5km==TRUE)
Census1990$LLAVE=paste0(Census1990$CVE_ENT,Census1990$CVE_MUN,Census1990$CVE_LOC)
Census1990=Census1990%>%
filter(LLAVE%in%Locations$LLAVE)%>%
mutate(Within_5km=LLAVE %in% Locations_within_5$LLAVE)
Census1990$CVE_ENT=NULL
Census1990$CVE_MUN=NULL
Census1990$CVE_LOC=NULL
Census1990$LLAVE=NULL
library(modelsummary)
#multiply all except Population by 100
Census1990[,c("Share_analf","econ_active","unemployed","Share_indig","Share_electicity","Share_piped_water")]=Census1990[,c("Share_analf","econ_active","unemployed","Share_indig","Share_electicity","Share_piped_water")]*100
#multiply all except Population by 100
Census1990[, -which(names(Census1990) == "Population" | names(Census1990) == "Within_5km")] <-
Census1990[, -which(names(Census1990) == "Population" | names(Census1990) == "Within_5km")] * 100
Census1990
datasummary_balance(~ Within_5km, data = Census1990, output="latex", stars=TRUE)
#calculate share economically active, share unemployed, share analfabetic, share indigenous, share with electricity, share with piped water
Census1990=Census1990%>%
mutate(econ_active=econ_act/(econ_act+econ_inact))%>%
mutate(unemployed=(econ_act-ocupada)/econ_act)%>%
mutate(Share_analf=pop_15_analf/(pop_15_analf+pop_15_alf))%>%
mutate(Share_indig=ind/(ind+no_ind))%>%
mutate(Share_electicity=total_viviendas_electricity/total_viviendas)%>%
mutate(Share_piped_water=total_viviendas_agua_entubada/total_viviendas)%>%
mutate(Share_scrap_materials=scrap_materials/total_viviendas)%>%
mutate(Share_at_school_614=school614/(school614+noschool614))%>%
mutate(Share_primary_sector=`primary sector`/ocupada)%>%
mutate(Share_secondary_sector=`secondary sector`/ocupada)%>%
mutate(Share_tertiary_sector=`tertiary sector`/ocupada)
Census1990<- read.delim("C:/Users/kzysi/Dropbox/Air pollution intergenerational effect/data/Census/1990/ITER_NALTXT90.txt", header=FALSE, comment.char="#")
names(Census1990)[1]=c("entidad")
names(Census1990)[3]=c("mun")
names(Census1990)[5]=c("loc")
Census1990$CVE_ENT=str_pad(Census1990$entidad, width = 2, side = "left", pad = "0")
Census1990$CVE_MUN=str_pad(Census1990$mun, width = 3, side = "left", pad = "0")
Census1990$CVE_LOC=str_pad(Census1990$loc, width = 4, side = "left", pad = "0")
Census1990=Census1990%>%
filter(CVE_LOC!="0000")%>%
filter(CVE_MUN!="000")
#number of localities
#population size
#share of population 15 who is analfabetic
#share of uemployed - 1-occupied/economically active
#share population which only speaks indigenous language
#share of household with electricity
#share of houesholds with piped water
names(Census1990)[10]=c("Population")
names(Census1990)[15]=c("pop_15_alf")
names(Census1990)[16]=c("pop_15_analf")
names(Census1990)[21]=c("no_ind")
names(Census1990)[22]=c("ind")
names(Census1990)[27]=c("econ_act")
names(Census1990)[28]=c("econ_inact")
names(Census1990)[29]=c("ocupada") #tasa de ocupacion: ese/econ_act
names(Census1990)[34]=c("total_viviendas")
names(Census1990)[43]=c("total_viviendas_agua_entubada")
names(Census1990)[45]=c("total_viviendas_electricity")
names(Census1990)[39]=c("scrap_materials")
names(Census1990)[19]=c("school614")
names(Census1990)[20]=c("noschool614")
names(Census1990)[30]=c("primary sector")
names(Census1990)[31]=c("secondary sector")
names(Census1990)[32]=c("tertiary sector")
#transform them to numeric
Census1990$Population=as.numeric(as.character(Census1990$Population))
Census1990$pop_15_alf=as.numeric(as.character(Census1990$pop_15_alf))
Census1990$pop_15_analf=as.numeric(as.character(Census1990$pop_15_analf))
Census1990$no_ind=as.numeric(as.character(Census1990$no_ind))
Census1990$ind=as.numeric(as.character(Census1990$ind))
Census1990$econ_act=as.numeric(as.character(Census1990$econ_act))
Census1990$econ_inact=as.numeric(as.character(Census1990$econ_inact))
Census1990$ocupada=as.numeric(as.character(Census1990$ocupada))
Census1990$total_viviendas=as.numeric(as.character(Census1990$total_viviendas))
Census1990$total_viviendas_agua_entubada=as.numeric(as.character(Census1990$total_viviendas_agua_entubada))
Census1990$total_viviendas_electricity=as.numeric(as.character(Census1990$total_viviendas_electricity))
Census1990$scrap_materials=as.numeric(as.character(Census1990$scrap_materials))
Census1990$school614=as.numeric(as.character(Census1990$school614))
Census1990$noschool614=as.numeric(as.character(Census1990$noschool614))
Census1990$`primary sector`=as.numeric(as.character(Census1990$`primary sector`))
Census1990$`secondary sector`=as.numeric(as.character(Census1990$`secondary sector`))
Census1990$`tertiary sector`=as.numeric(as.character(Census1990$`tertiary sector`))
#calculate share economically active, share unemployed, share analfabetic, share indigenous, share with electricity, share with piped water
Census1990=Census1990%>%
mutate(econ_active=econ_act/(econ_act+econ_inact))%>%
mutate(unemployed=(econ_act-ocupada)/econ_act)%>%
mutate(Share_analf=pop_15_analf/(pop_15_analf+pop_15_alf))%>%
mutate(Share_indig=ind/(ind+no_ind))%>%
mutate(Share_electicity=total_viviendas_electricity/total_viviendas)%>%
mutate(Share_piped_water=total_viviendas_agua_entubada/total_viviendas)%>%
mutate(Share_scrap_materials=scrap_materials/total_viviendas)%>%
mutate(Share_at_school_614=school614/(school614+noschool614))%>%
mutate(Share_primary_sector=`primary sector`/ocupada)%>%
mutate(Share_secondary_sector=`secondary sector`/ocupada)%>%
mutate(Share_tertiary_sector=`tertiary sector`/ocupada)
#keep only total population plusthe characteristics above:
Census1990=Census1990%>%
select("CVE_ENT","CVE_MUN","CVE_LOC","Population","econ_active","unemployed","Share_primary_sector","Share_secondary_sector","Share_tertiary_sector",
"Share_analf","Share_indig","Share_electicity","Share_piped_water",
"Share_scrap_materials","Share_at_school_614",)
library(sf)
Highways=st_read("C:/Users/kzysi/Dropbox/Air pollution intergenerational effect/data/Shapefiles/Highways2000/carretera.shp")
ggplot(Highways)+geom_sf()
table(Highways$NO_CARRILE)
Highways=Highways%>%
filter(TIPO!="Terracería") ###only paved roads
##Federal Highways
Highways=Highways%>%
filter(ADMINISTRA=="Federal")
buffer_5km <- st_buffer(Highways, dist = 5000)
locations_sf <- st_as_sf(Locations, coords = c("Longitud", "Latitud"), crs = 4326)
locations_sf <- st_transform(locations_sf, crs = st_crs(Highways))
Locations$localities_within_5km <- lengths(st_within(locations_sf, buffer_5km))>0
Locations$LLAVE=paste0(Locations$CVE_ENT,Locations$CVE_MUN,Locations$CVE_LOC)
Locations_within_5=Locations%>%
filter(localities_within_5km==TRUE)
Census1990$LLAVE=paste0(Census1990$CVE_ENT,Census1990$CVE_MUN,Census1990$CVE_LOC)
Census1990=Census1990%>%
filter(LLAVE%in%Locations$LLAVE)%>%
mutate(Within_5km=LLAVE %in% Locations_within_5$LLAVE)
Census1990$CVE_ENT=NULL
Census1990$CVE_MUN=NULL
Census1990$CVE_LOC=NULL
Census1990$LLAVE=NULL
library(modelsummary)
#multiply all except Population by 100
Census1990[, -which(names(Census1990) == "Population" | names(Census1990) == "Within_5km")] <-
Census1990[, -which(names(Census1990) == "Population" | names(Census1990) == "Within_5km")] * 100
datasummary_balance(~ Within_5km, data = Census1990, output="latex", stars=TRUE)
?datasummary_balance
library(tidyverse)
library(fixest)
load("C:/Users/kzysi/Dropbox/Air pollution intergenerational effect/data/Direct_regressions_data.Rda")
MR_E=Direct_data[[1]]
Fertility=Direct_data[[2]]
Inf_mort=Direct_data[[3]]
reg1=feols(Mortality_per_1000_births~ share_within_5km*full_pregnancy_exposure|
MUN+substr(MUN,1,2)^Date, data=MR_E, weights=~W)
reg2=feols(bper1000w~ share_within_5km*full_pregnancy_exposure|
MUN+substr(MUN,1,2)^Date, data=Fertility, weights=Fertility$Female_pop)
reg3=feols(Mortality1000~share_within_5km*full_pregnancy_exposure|
MUN+substr(MUN,1,2)^Date, data=Inf_mort, weights=Inf_mort$Count)
etable(reg1,reg2,reg3)
etable(reg1,reg2,reg3, tex=TRUE)
library(tidyverse)
library(data.table)
library(readxl)
library(fixest)
library(broom)
# Load data
load("C:/Users/kzysi/Dropbox/Air pollution intergenerational effect/data/births/Denominator_all_births_1985_2007_monthly.RData")
load("C:/Users/kzysi/Dropbox/Air pollution intergenerational effect/data/deaths/Inf_mort_nominator_monthly.RData")
load("C:/Users/kzysi/Dropbox/Air pollution intergenerational effect/data/Localities/Exposure_federal.Rda")
# Merge datasets
Inf_mort <- merge(
Inf_mort_nominator, Denominator_births,
by.x = c("mkey", "ANIO_NACIM", "MES_NACIM"),
by.y = c("mkey", "ANO_NAC", "MES_NAC")
) %>%
merge(Exposure, by.x = "mkey", by.y = "MUN") %>%
mutate(
Date = round((as.numeric(ANIO_NACIM) * 12 + MES_NACIM) / 12, 2),
deaths = n,
Mortality1000 = n / Count * 1000,
MUN = mkey,
CVE_ENT = ENT_RESID,
exposed = share_within_5km > 0.5,
Year = as.numeric(ANIO_NACIM) # keep year for event study
)%>%
filter(Year<2000)
# Relevel year factor: 1991 as baseline
Inf_mort <- Inf_mort %>%
mutate(Year_f = relevel(factor(Year), ref = "1991"))
Inf_mort
# Merge datasets
Inf_mort <- merge(
Inf_mort_nominator, Denominator_births,
by.x = c("mkey", "ANIO_NACIM", "MES_NACIM"),
by.y = c("mkey", "ANO_NAC", "MES_NAC")
) %>%
merge(Exposure, by.x = "mkey", by.y = "MUN") %>%
mutate(
Date = round((as.numeric(ANIO_NACIM) * 12 + MES_NACIM) / 12, 2),
deaths = n,
Mortality1000 = n / Count * 1000,
MUN = mkey,
CVE_ENT = ENT_RESID,
exposed = share_within_5km > 0.5,
Year = as.numeric(ANIO_NACIM) # keep year for event study
)%>%
filter(Year<=1990)
Inf_mort
#for each municipality, calculate average mortality (n by count), and whether it's exposed or not
Inf_mort_mun <- Inf_mort %>%
group_by(MUN) %>%
summarise(
avg_mortality = sum(deaths) / sum(Count) * 1000,
exposed = mean(exposed),
)
source("C:/Users/kzysi/Dropbox/Air pollution intergenerational effect/program/Results/26_infant_mortality_statistics_convergence.R", echo = TRUE)
#for each municipality, calculate average mortality (n by count), and whether it's exposed or not
Inf_mort_mun
#calculate weighted mean, standard deviation and difference and its standard deviatoion by exposed
weighted_mean_exposed <- weighted.mean(Inf_mort_mun$avg_mortality[Inf_mort_mun$exposed == 1], w = Inf_mort_mun$Count[Inf_mort_mun$exposed == 1])
Inf_mort_mun
#for each municipality, calculate average mortality (n by count), and whether it's exposed or not
Inf_mort_mun <- Inf_mort %>%
group_by(MUN) %>%
summarise(
Count=sum(Count),
avg_mortality = sum(deaths) / sum(Count) * 1000,
exposed = mean(exposed),
)
#calculate weighted mean, standard deviation and difference and its standard deviatoion by exposed
weighted_mean_exposed <- weighted.mean(Inf_mort_mun$avg_mortality[Inf_mort_mun$exposed == 1], w = Inf_mort_mun$Count[Inf_mort_mun$exposed == 1])
weighted_mean_unexposed <- weighted.mean(Inf_mort_mun$avg_mortality[Inf_mort_mun$exposed == 0], w = Inf_mort_mun$Count[Inf_mort_mun$exposed == 0])
weighted_sd_exposed <- sqrt(Hmisc::wtd.var(Inf_mort_mun$avg_mortality[Inf_mort_mun$exposed == 1], weights = Inf_mort_mun$Count[Inf_mort_mun$exposed == 1]))
weighted_sd_unexposed <- sqrt(Hmisc::wtd.var(Inf_mort_mun$avg_mortality[Inf_mort_mun$exposed == 0], weights = Inf_mort_mun$Count[Inf_mort_mun$exposed == 0]))
difference <- weighted_mean_exposed - weighted_mean_unexposed
weighted_mean_exposed
weighted_mean_unexposed
weighted_sd_exposed
weighted_sd_unexposed
difference <- weighted_mean_exposed - weighted_mean_unexposed
se_difference <- sqrt((weighted_sd_exposed^2 / sum(Inf_mort_mun$Count[Inf_mort_mun$exposed == 1])) + (weighted_sd_unexposed^2 / sum(Inf_mort_mun$Count[Inf_mort_mun$exposed == 0])))
difference
weighted_mean_exposed
weighted_mean_unexposed
weighted_sd_exposed
weighted_sd_unexposed
difference
se_difference
#now divide counties into tertiles
Inf_mort_mun <- Inf_mort_mun %>%
mutate(
tertile = ntile(avg_mortality, 3)
)
Inf_mort_mun
#what are they?
table(Inf_mort_mun$tertile)
Inf_mort_mun %>%
group_by(tertile) %>%
summarise(
Count = sum(Count),
avg_mortality = weighted.mean(avg_mortality, w = Count),
sd_mortality = sqrt(Hmisc::wtd.var(avg_mortality, weights = Count)),
exposed = mean(exposed)
)
Inf_mort_mun %>%
group_by(tertile) %>%
summarise(
Count = sum(Count),
avg_mortality = weighted.mean(avg_mortality, w = Count))
Inf_mort_mun %>%
group_by(tertile) %>%
summarise(
Count2 = sum(Count),
avg_mortality = weighted.mean(avg_mortality, w = Count2))
quantile(Inf_mort_mun$avg_mortality, probs = c(0, 1/3, 2/3, 1))
#merge each data set with Inf_mort_mun to get the tertile information
MR_E=merge(MR_E, Inf_mort_mun[,c("MUN","tertile")], by="MUN")
reg1=feols(Mortality_per_1000_births~ share_within_5km*full_pregnancy_exposure|
MUN+substr(MUN,1,2)^Date, data=MR_E, weights=~W, split=~tertile)
reg1
reg1=feols(Mortality_per_1000_births~ share_within_5km*full_pregnancy_exposure|
MUN+substr(MUN,1,2)^Date, data=MR_E, weights=~W, fsplit=~tertile)
reg1
reg1=feols(Mortality_per_1000_births~ share_within_5km*full_pregnancy_exposure|
MUN+Date, data=MR_E, weights=~W, fsplit=~tertile)
reg1
Fertility=merge(Fertility, Inf_mort_mun[,c("MUN","tertile")], by="MUN")
reg2=feols(bper1000w~ share_within_5km*full_pregnancy_exposure|
MUN+Date, data=Fertility, weights=~Female_pop, split=~tertile)
reg2
Inf_mort=merge(Inf_mort, Inf_mort_mun[,c("MUN","tertile")], by="MUN")
reg3=feols(Mortality1000~share_within_5km*full_pregnancy_exposure|
MUN+Date, data=Inf_mort, weights=~Count, split=~tertile)
Inf_mort
reg3=feols(Mortality1000~share_within_5km*full_pregnancy_exposure|
MUN+Date, data=Inf_mort, weights=~Count, split=~tertile)
MR_E=Direct_data[[1]]
Fertility=Direct_data[[2]]
Inf_mort=Direct_data[[3]]
Inf_mort
reg3=feols(Mortality1000~share_within_5km*full_pregnancy_exposure|
MUN+Date, data=Inf_mort, weights=~Count, split=~tertile)
Inf_mort=merge(Inf_mort, Inf_mort_mun[,c("MUN","tertile")], by="MUN")
reg3=feols(Mortality1000~share_within_5km*full_pregnancy_exposure|
MUN+Date, data=Inf_mort, weights=~Count, split=~tertile)
etable(reg1,reg2,reg3, tex=TRUE)
reg3
etable(reg1,reg2,reg3, tex=TRUE)
load("C:/Users/kzysi/Dropbox/Air pollution intergenerational effect/data/Direct_regressions_data.Rda")
MR_E=Direct_data[[1]]
Fertility=Direct_data[[2]]
Inf_mort=Direct_data[[3]]
#merge each data set with Inf_mort_mun to get the tertile information
MR_E=merge(MR_E, Inf_mort_mun[,c("MUN","tertile")], by="MUN")
reg1=feols(Mortality_per_1000_births~ share_within_5km*full_pregnancy_exposure|
MUN+Date, data=MR_E, weights=~W, split=~tertile)
Fertility=merge(Fertility, Inf_mort_mun[,c("MUN","tertile")], by="MUN")
reg2=feols(bper1000w~ share_within_5km*full_pregnancy_exposure|
MUN+Date, data=Fertility, weights=~Female_pop, split=~tertile)
Inf_mort=merge(Inf_mort, Inf_mort_mun[,c("MUN","tertile")], by="MUN")
reg3=feols(Mortality1000~share_within_5km*full_pregnancy_exposure|
MUN+Date, data=Inf_mort, weights=~Count, split=~tertile)
etable(reg1,reg2,reg3, tex=TRUE)
reg1=feols(Mortality_per_1000_births~ share_within_5km*full_pregnancy_exposure|
MUN+tertile^Date, data=MR_E, weights=~W)
reg1
#merge each data set with Inf_mort_mun to get the tertile information
MR_E=merge(MR_E, Inf_mort_mun[,c("MUN","tertile")], by="MUN")
reg1=feols(Mortality_per_1000_births~ share_within_5km*full_pregnancy_exposure|
MUN+tertile^Date, data=MR_E, weights=~W)
load("C:/Users/kzysi/Dropbox/Air pollution intergenerational effect/data/Direct_regressions_data.Rda")
MR_E=Direct_data[[1]]
Fertility=Direct_data[[2]]
Inf_mort=Direct_data[[3]]
#merge each data set with Inf_mort_mun to get the tertile information
MR_E=merge(MR_E, Inf_mort_mun[,c("MUN","tertile")], by="MUN")
reg1=feols(Mortality_per_1000_births~ share_within_5km*full_pregnancy_exposure|
MUN+tertile^Date, data=MR_E, weights=~W)
Fertility=merge(Fertility, Inf_mort_mun[,c("MUN","tertile")], by="MUN")
reg2=feols(bper1000w~ share_within_5km*full_pregnancy_exposure|
MUN+tertile^Date, data=Fertility, weights=~Female_pop)
Inf_mort=merge(Inf_mort, Inf_mort_mun[,c("MUN","tertile")], by="MUN")
reg3=feols(Mortality1000~share_within_5km*full_pregnancy_exposure|
MUN+Date^tertile, data=Inf_mort, weights=~Count)
etable(reg1,reg2,reg3, tex=TRUE)
load("C:/Users/kzysi/Dropbox/Air pollution intergenerational effect/data/Direct_regressions_data.Rda")
MR_E=Direct_data[[1]]
Fertility=Direct_data[[2]]
Inf_mort=Direct_data[[3]]
#merge each data set with Inf_mort_mun to get the tertile information
MR_E=merge(MR_E, Inf_mort_mun[,c("MUN","tertile")], by="MUN")
reg1=feols(Mortality_per_1000_births~ share_within_5km*full_pregnancy_exposure|
MUN+tertile^Date, data=MR_E, weights=~W)
Fertility=merge(Fertility, Inf_mort_mun[,c("MUN","tertile")], by="MUN")
reg2=feols(bper1000w~ share_within_5km*full_pregnancy_exposure|
MUN+tertile^Date, data=Fertility, weights=~Female_pop)
Inf_mort=merge(Inf_mort, Inf_mort_mun[,c("MUN","tertile")], by="MUN")
reg3=feols(Mortality1000~share_within_5km*full_pregnancy_exposure|
MUN+tertile^Date, data=Inf_mort, weights=~Count)
etable(reg1,reg2,reg3, tex=TRUE)
library(readxl)
Localized_Lead_Sources <- read_excel("C:/Users/kzysi/Dropbox/Air pollution intergenerational effect/data/RA_Salvador/Week 6/Week 6/Alternative Lead Sources/Localized Lead Sources.xlsx")
View(Localized_Lead_Sources)
library(tidyverse)
library(fixest)
load("C:/Users/kzysi/Dropbox/Air pollution intergenerational effect/data/Direct_regressions_data.Rda")
MR_E=Direct_data[[1]]
Fertility=Direct_data[[2]]
Inf_mort=Direct_data[[3]]
reg1=feols(Mortality_per_1000_births~ share_within_5km*full_pregnancy_exposure|
MUN+Date, data=MR_E[!MR_E$MUN%in%Localized_Lead_Sources$`Municipality code`], weights=~W)
reg1=feols(Mortality_per_1000_births~ share_within_5km*full_pregnancy_exposure|
MUN+Date, data=MR_E[!MR_E$MUN%in%Localized_Lead_Sources$`Municipality code`,], weights=~W)
reg2=feols(bper1000w~ share_within_5km*full_pregnancy_exposure|
MUN+Date, data=Fertility[!Fertility$MUN%in%Localized_Lead_Sources$`Municipality code`,], weights=~Female_pop)
load("C:/Users/kzysi/Dropbox/Air pollution intergenerational effect/data/Direct_regressions_data.Rda")
MR_E=Direct_data[[1]]
Fertility=Direct_data[[2]]
Inf_mort=Direct_data[[3]]
reg1=feols(Mortality_per_1000_births~ share_within_5km*full_pregnancy_exposure|
MUN+Date, data=MR_E[!MR_E$MUN%in%Localized_Lead_Sources$`Municipality code`,], weights=~W)
reg2=feols(bper1000w~ share_within_5km*full_pregnancy_exposure|
MUN+Date, data=Fertility[!Fertility$MUN%in%Localized_Lead_Sources$`Municipality code`,], weights=~Female_pop)
reg3=feols(Mortality1000~share_within_5km*full_pregnancy_exposure|
MUN+Date, data=Inf_mort[!Inf_mort$MUN%in%Localized_Lead_Sources$`Municipality code`,], weights=~Count)
etable(reg1,reg2,reg3, tex=TRUE)
etable(reg1,reg2,reg3, tex=TRUE)
