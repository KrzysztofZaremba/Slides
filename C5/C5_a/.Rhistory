summary(reg1)
reg1=lm(final~attend, data=attend)
summary(reg1)
summary(attend$final)
reg1=lm(final~atndrte, data=attend)
summary(reg1)
reg1=lm(final~attend+hwrte, data=attend)
summary(reg1)
reg1=lm(final~attend*hwrte, data=attend)
summary(reg1)
reg1=lm(final~attend*priGPA, data=attend)
summary(reg1)
reg1=lm(final~attend*ACT, data=attend)
summary(reg1)
reg1=lm(final~attend*termGPA, data=attend)
summary(reg1)
reg1=lm(pentree~attend*termGPA, data=discrim)
reg1=lm(pentree~prpblck, data=discrim)
summary(reg1)
reg1=lm(pentree~prpblck+income, data=discrim)
summary(reg1)
reg1=lm(pentree~prpblck*income, data=discrim)
summary(reg1)
reg1=lm(pentree~prpblckcrmrte, data=discrim)
reg1=lm(pentree~prpblck+crmrte, data=discrim)
summary(reg1)
reg1=lm(pentree~prpblck*chain, data=discrim)
summary(reg1)
reg1=lm(pentree~prpblck*as.factor(chain), data=discrim)
summary(reg1)
reg1=lm(score~study, data=econmath)
summary(reg1)
reg1=lm(score~study*• hsgpa:, data=econmath)
reg1=lm(score~study*hsgpa, data=econmath)
summary(reg1)
reg1=lm(score~study*act, data=econmath)
summary(reg1)
loanapp$action
reg1=lm(slpnaps~earns74, data=sleep75)
summary(reg1)
reg1=lm(slpnaps~hrwage, data=sleep75)
summary(reg1)
reg1=lm(slpnaps~hrwage+spsepay, data=sleep75)
summary(reg1)
reg1=lm(slpnaps~hrwage*spsepay, data=sleep75)
summary(reg1)
reg1=lm(slpnaps~hrwage*exper, data=sleep75)
summary(reg1)
reg1=lm(slpnaps~hrwage*selfe, data=sleep75)
summary(reg1)
reg1=lm(slpnaps~hrwage*educ, data=sleep75)
summary(reg1)
reg1=lm(wage~IQ*educ, data=wage2)
summary(reg1)
reg1=lm(outofpocket_costs~age*income, data=wage2)
reg1=lm(outofpocket_costs~age*income, data=hrs)
summary(reg1)
loanapp$action
reg1=lm(outofpocket_costs~age*income, data=hrs)
summary(reg1)
reg1=lm(medical_costs~age*income, data=hrs)
summary(reg1)
reg1=lm(medical_costs~age*hosp_nights, data=hrs)
summary(reg1)
zloanapp$action
reg1=lm(outofpocket_costs~age*hosp_nights, data=hrs)
summary(reg1)
reg1=lm(outofpocket_costs~age*assets, data=hrs)
summary(reg1)
reg1=lm(medical_costs~age*assets, data=hrs)
summary(reg1)
reg1=lm(doctor_visits~age*assets, data=hrs)
summary(reg1)
reg1=lm(saleprice~lotarea+yearbuilt, data=houseprices)
summary(reg1)
reg1=lm(saleprice~lotarea*yearbuilt, data=houseprices)
summary(reg1)
reg1=lm(saleprice~lotarea*yearremodadd, data=houseprices)
summary(reg1)
reg1=lm(saleprice~bedroomabvgr*yearremodadd, data=houseprices)
summary(reg1)
reg1=lm(saleprice~bedroomabvgr*yearbuilt
, data=houseprices)
reg1=lm(saleprice~bedroomabvgr*yearbuilt, data=houseprices)
summary(reg1)
reg1=lm(saleprice~totrmsabvgrd*yearbuilt, data=houseprices)
summary(reg1)
reg1=lm(saleprice~lotarea*yearbuilt, data=houseprices)
summary(reg1)
zloanapp$action
reg1=lm(final~1, data=attend)
summary(reg1)
reg1=lm(final~attend, data=attend)
summary(reg1)
reg1=lm(final~attend+ACT, data=attend)
summary(reg1)
reg1=lm(final~attend+ACT+termGPA, data=attend)
summary(reg1)
reg1=lm(final~attend+ACT+termGPA+priGPA, data=attend)
summary(reg1)
reg1=lm(final~attend+ACT+termGPA, data=attend)
summary(reg1)
reg1=lm(final~attend+ACT+termGPA+priGPA, data=attend)
summary(reg1)
reg1=lm(final~atndrte+ACT+termGPA+priGPA, data=attend)
summary(reg1)
reg1=lm(final~attend+hwrte+ACT+termGPA+priGPA, data=attend)
summary(reg1)
reg1=lm(final~attend+ACT+termGPA+priGPA+frosh, data=attend)
summary(reg1)
reg1=lm(final~attend+ACT+termGPA+priGPA, data=attend)
summary(reg1)
lm(approve~cpi+unemploy, data=approval)
s1=lm(approve~cpi+unemploy, data=approval)
summary(s1)
s1=lm(employ~abuse*educ, data=alcohol)
table(s1)
s1=lm(employ~abuse*educ, data=alcohol)
summary(s1)
s1=lm(employ~abuse+educ, data=alcohol)
s1=lm(employ~abuse*age, data=alcohol)
summary(s1)
s1=lm(employ~abuse(*age)white, data=alcohol)
s1=lm(employ~abuse*white, data=alcohol)
summary(s1)
s1=lm(abuse~beertax, data=alcohol)
summary(s1)
s1=lm(pfries~abuse+educ, data=alcohol)
summary(s1)
s1=lm(employ~abuse+educ, data=alcohol)
summary(s1)
s1=lm(employ~abuse*married, data=alcohol)
summary(s1)
s1=lm(employ~abuse*famsize, data=alcohol)
summary(s1)
s1=lm(employ~abuse+married, data=alcohol)
summary(s1)
s1=lm(employ~abuse+married+education, data=alcohol)
summary(s1)
s1=lm(employ~abuse+married+educ, data=alcohol)
summary(s1)
s1=lm(employ~abuse+married, data=alcohol)
summary(s1)
s1=lm(murdrate~execs, data=countymurders)
summary(s1)
s1=lm(murdrate~execrate, data=countymurders)
summary(s1)
s1=lm(slnone~execrate, data=driving)
summary(s1)
s1=lm(totfatpvm~slnone, data=driving)
summary(s1)
s1=lm(totfatpvm~minage, data=driving)
summary(s1)
s1=lm(totfatpvm~minage*sbprim, data=driving)
summary(s1)
s1=lm(totfatpvm~minage+sbprim, data=driving)
summary(s1)
s1=lm(totfatpvm~minage*sbprim, data=driving)
summary(s1)
s1=lm(wage~educ*bigcity, data=beauty)
summary(s1)
s1=lm(slpnaps~age+educ+marr+hr, data=alcohol)
s1=lm(slpnaps~age+educ+marr+hr, data=sleep)
summary(s1)
s1=lm(slpnaps~age+educ+marr+hr, data=sleep)
s1=lm(slpnaps~age+educ+marr+hr, data=sleep75)
summary(s1)
s1=lm(slpnaps~age+educ+marr+hr, data=sleep75)
s1=lm(slpnaps~age+educ+marr+hrwage, data=sleep75)
summary(s1)
s1=lm(slpnaps~age+educ+hrwage, data=sleep75)
summary(s1)
s1=lm(slpnaps~educ+hrwage, data=sleep75)
summary(s1)
s1=lm(slpnaps~age+hrwage, data=sleep75)
summary(s1)
s1=lm(slpnaps~age+married+hrwage, data=sleep75)
summary(s1)
s1=lm(slpnaps~age+marr+hrwage, data=sleep75)
summary(s1)
s1=lm(slpnaps~age+yngkid+hrwage, data=sleep75)
summary(s1)
s1=lm(slpnaps~age+male+hrwage, data=sleep75)
summary(s1)
s1=lm(slpnaps~age+maarr+hrwage, data=sleep75)
s1=lm(slpnaps~age+marr+hrwage, data=sleep75)
summary(s1)
lm_model <- lm(salary ~ college+grad+age, data = Sample_urg)
lm_model <- lm(salary ~ college+grad+age, data = ceosal2)
lm_model
summary(lm_model)
summary(econmath$act)
lm_model <- lm(score ~ age+study+act+age+fathcoll+mothcoll, data = econmath)
new_data<- data.frame(age=22, study=10, act=25, fathcoll=0, mothcoll=1)
predict(lm_model, newdata = new_data, interval = "confidence", level = 0.95, se.fit=TRUE)
summary(lm_model)
new_data<- data.frame(age=22, study=10, act=25, fathcoll=0, mothcoll=1)
lm_model <- lm(score ~ age+study+act+fathcoll+mothcoll+male, data = econmath)
summary(lm_model)
lm_model <- lm(score ~ age+study+act+fathcoll+mothcoll+male, data = econmath)
summary(lm_model)
new_data<- data.frame(age=22, study=10, act=25, fathcoll=0, mothcoll=1, male=1)
predict(lm_model, newdata = new_data, interval = "confidence", level = 0.95, se.fit=TRUE)
predict(lm_model, newdata = new_data, interval = "prediction", level = 0.95, se.fit=TRUE)
lm_model <- lm(pfries ~ wagest+hrsopen+emp, data = econmath)
lm_model <- lm(pfries ~ wagest+hrsopen+emp, data = discrim)
summary(lm_model)
lm_model <- lm(pfries ~ prpblck+prppov+income, data = discrim)
summary(lm_model)
anova(lm_model)
0.0193+0.0850+0.2333+4.0566
var(discrim$pfries)*(nrow(discrim)-1)
var(discrim$pfries, na.rm = TRUE)*(nrow(discrim)-1)
0.0193+0.0850+0.2333+4.0566
?anova
0.2333+4.0566
linearHypothesis(lm_model, c("prpblck=0", "prppov=0","income=0"))
library(car)
linearHypothesis(lm_model, c("prpblck=0", "prppov=0","income=0"))
anova(lm_model)
0.0193+0.0850+0.2333
(0.0193+0.0850+0.2333)/3
((0.0193+0.0850+0.2333)/3)/(4.0566/388)
pF(10.76343, df1=3, df2=388, lower.tail=FALSE)
pf(10.76343, df1=3, df2=388, lower.tail=FALSE)
pf(10.76343, df1=3, df2=388)
basic=lm(wagehr ~gender, data=cps)
summary(basic)
explained=lm(wagehr ~gender+educ, data=cps)
summary(explained)
explained=lm(wagehr ~gender+hrslastwk, data=cps)
summary(explained)
explained=lm(wagehr ~gender+hrslastwk+marstatus, data=cps)
summary(explained)
explained=lm(wagehr ~gender+hrslastwk+marstatus+age, data=cps)
summary(explained)
a=lm(famincome~bmi_w+bmi_h)
a=lm(famincome~bmi_w+bmi_h, data=married)
summary(a)
a=lm(famincome~educ_w+educ_h, data=married)
summary(a)
a=lm(famincome~educ_w+educ_h, data=married)
summary(a)
vcov(a)
library(renderthis)
pagedown::chrome_print(input = "C_5_slides_a.html", output = "C_5_slides_a.pdf", timeout = 300)
library(learnr)
library(shiny)
library(tidyverse)
if (!requireNamespace("car", quietly = TRUE)) {
install.packages("car", repos = "https://cloud.r-project.org")
}
if (!requireNamespace("plotly", quietly = TRUE)) {
install.packages("plotly", repos = "https://cloud.r-project.org")
}
if (!requireNamespace("tseries", quietly = TRUE)) {
install.packages("tseries", repos = "https://cloud.r-project.org")
}
library(plotly)
library(car)
library(tseries)
if (!requireNamespace("probstats4econ", quietly = TRUE)) {
install.packages("probstats4econ", repos = "https://cloud.r-project.org")
}
library(probstats4econ)
if (!requireNamespace("wooldridge", quietly = TRUE)) {
install.packages("wooldridge", repos = "https://cloud.r-project.org")
}
library(wooldridge)
# Fixed data generation
set.seed(123) # For reproducibility
x <- seq(-10, 10, by = 1)
e <- rnorm(length(x), mean = 0, sd = 5)
y_actual <- 4 + 1.65 * x + e
data <- data.frame(x, y_actual)
X=cbind(1, affairs$age, affairs$relig)
y=affairs$naffairs
X <- cbind(1, affairs$age, affairs$relig)
y <- affairs$naffairs
beta_hat <- solve(t(X) %*% X) %*% (t(X) %*% y)
beta_hat
y_hat <- X %*% beta_hat
y_hat
x_new <- c(1, 40, 3)
y_pred <- x_new %*% beta_hat
y_pred
m1 <- lm(wage ~ educ, data = card)
coef(m1)
# Regression 2: wage on educ and IQ
m2 <- lm(wage ~ educ + IQ, data = card)
coef(m2)
X <- cbind(1, affairs$age, affairs$relig)
y <- affairs$naffairs
n <- nrow(X)
k <- ncol(X)
# OLS estimates
beta_hat <- solve(t(X) %*% X) %*% (t(X) %*% y)
# Residuals
u_hat <- y - X %*% beta_hat
# Estimate of error variance
sigma2 <- as.numeric(t(u_hat) %*% u_hat / (n - k))
# Variance–covariance matrix (long form)
VCOV_long <- sigma2 * solve(t(X) %*% X)
VCOV_long
vcov(m)
# OR simply
m <- lm(naffairs ~ age + relig, data = affairs)
vcov(m)
# Regress lot area on age
m <- lm(salesprice~lotarea*yearbuilt, data = house)
# Show regression output
summary(m)
# Regress lot area on age
m <- lm(salesprice~lotarea*yearbuilt, data = housesales)
# Regress lot area on age
m <- lm(salesprice~lotarea*yearbuilt, data = houseprices)
# Regress lot area on age
m <- lm(salesprice~lotarea*yearbuilt, data = houseprices)
# Regress lot area on age
m <- lm(saleprice~lotarea*yearbuilt, data = houseprices)
# Show regression output
summary(m)
m <- lm(wagehr ~ educ * race, data = cps)
summary(m)
# Regression using all variables
m <- lm(slpnaps ~ hrwage + age + marr, data = sleep75)
summary(m)
# 95% confidence interval for hourly wage effect
ci_hrwage <- confint(m, "hrwage", level = 0.95)
# 95% confidence interval for being married
ci_marr <- confint(m, "marr", level = 0.95)
# 95% confidence interval for hourly wage effect
confint(m, level = 0.95)
coefs   <- summary(m)$coefficients
beta_hr <- coefs["hrwage", "Estimate"]
se_hr   <- coefs["hrwage", "Std. Error"]
beta_marr <- coefs["marr", "Estimate"]
se_marr   <- coefs["marr", "Std. Error"]
df <- m$df.residual
t_crit <- qt(0.975, df = df)   # two-sided 95% → 0.975 quantile
# Manual CI for hrwage:
lower_hr  <- beta_hr  - t_crit * se_hr
upper_hr  <- beta_hr  + t_crit * se_hr
# Manual CI for marr:
lower_marr <- beta_marr - t_crit * se_marr
upper_marr <- beta_marr + t_crit * se_marr
c(CI_hrwage_manual = lower_hr, upper_hr)
c(CI_marr_manual   = lower_marr, upper_marr)
m <- lm(score ~ age + study + act + fathcoll + mothcoll + male, data = econmath)
summary(m)
# 2. Vector of predictors for the specific student:
#    age = 22, study = 10, act = 25, fathcoll = 0, mothcoll = 1, male = 1
x0 <- c(1, 22, 10, 25, 0, 1, 1)  # (Intercept, age, study, act, fathcoll, mothcoll, male)
# 3. Extract X and compute (X'X)^(-1)
X <- model.matrix(m)                 # Design matrix
XtX_inv <- solve(t(X) %*% X)         # (X'X)^(-1)
# 4. Get coefficient estimates and prediction for this student
beta_hat <- coef(m)
y_hat <- as.numeric(x0 %*% beta_hat) # Predicted mean score
# 5. Estimate error variance and standard error of prediction (mean)
n <- nrow(X)
k <- ncol(X)
s2 <- sum(residuals(m)^2) / (n - k)                     # sigma^2 hat
var_mean <- as.numeric(s2 * t(x0) %*% XtX_inv %*% x0)   # Var of predicted mean
se_mean <- sqrt(var_mean)                               # Standard error
X
# 4. Get coefficient estimates and prediction for this student
beta_hat <- coef(m)
y_hat <- as.numeric(x0 %*% beta_hat) # Predicted mean score
# 5. Estimate error variance and standard error of prediction (mean)
n <- nrow(X)
k <- ncol(X)
s2 <- sum(residuals(m)^2) / (n - k)                     # sigma^2 hat
var_mean <- as.numeric(s2 * t(x0) %*% XtX_inv %*% x0)   # Var of predicted mean
se_mean <- sqrt(var_mean)                               # Standard error
# 6. Critical value for 95% CI from t-distribution
df <- m$df.residual
t_crit <- qt(0.975, df = df)
# 7. Confidence interval for the mean predicted score
lower_ci <- y_hat - t_crit * se_mean
upper_ci <- y_hat + t_crit * se_mean
c(predicted_mean = y_hat,
lower_95_CI    = lower_ci,
upper_95_CI    = upper_ci)
ncol(X)
# 1. Run the regression model
m <- lm(score ~ age + study + act + fathcoll + mothcoll + male, data = econmath)
summary(m)
# 2. Vector of predictors for the specific student
#    age = 22, study = 10, act = 25, fathcoll = 0, mothcoll = 1, male = 1
#    x0 = (1, age, study, act, fathcoll, mothcoll, male)
x0 <- c(1, 22, 10, 25, 0, 1, 1)
# 3. Compute (X'X)^(-1)
X <- model.matrix(m)
XtX_inv <- solve(t(X) %*% X)
# 4. Predicted value ŷ0 = x0' * β̂
beta_hat <- coef(m)
y_hat <- as.numeric(x0 %*% beta_hat)
# 5. Standard error for a NEW observation
#    Var(ŷ_new) = σ² * (1 + x0' (X'X)^(-1) x0)
#    SE(ŷ_new)  = sqrt( Var(ŷ_new) )
n <- nrow(X)
p <- ncol(X)
s2 <- sum(residuals(m)^2) / (n - p)                      # σ² estimate
var_new <- as.numeric(s2 * (1 + t(x0) %*% XtX_inv %*% x0))
se_new  <- sqrt(var_new)
# 6. Critical value for 95% prediction interval
df <- m$df.residual
t_crit <- qt(0.975, df = df)
# 7. 95% prediction interval for a NEW observation
lower_pi <- y_hat - t_crit * se_new
upper_pi <- y_hat + t_crit * se_new
c(predicted_value      = y_hat,
lower_95_pred_int    = lower_pi,
upper_95_pred_int    = upper_pi)
lm_model <- lm(pfries ~ prpblck+prppov+income, data = discrim)
summary(lm_model)
```{r 17m3, exercise=TRUE, exercise.setup="17m2"}
anova_out <- anova(lm_model)
anova_out
SSE_anova <- anova_out["Residuals", "Sum Sq"]
SSR_anova <- sum(anova_out[1:3, "Sum Sq"])
anova_out <- anova(lm_model)
anova_out
SSE<- anova_out["Residuals", "Sum Sq"]
SSR <- sum(anova_out[1:3, "Sum Sq"]) #sum of regression squares of all variables
SST <- SSR_anova + SSE_anova
beta_diff <- b["educ_w"] - b["educ_h"]
var_diff <- V["educ_w", "educ_w"] +
V["educ_h", "educ_h"] -
2 * V["educ_w", "educ_h"]
t_stat <- beta_diff / sqrt(var_diff)
t_stat
o
# Extract coefficients
b <- coef(a)
a=lm(famincome~educ_w+educ_h, data=married)
summary(a)
# Extract coefficients
b <- coef(a)
# Extract variance–covariance matrix
V <- vcov(a)
beta_diff <- b["educ_w"] - b["educ_h"]
var_diff <- V["educ_w", "educ_w"] +
V["educ_h", "educ_h"] -
2 * V["educ_w", "educ_h"]
t_stat <- beta_diff / sqrt(var_diff)
t_stat
# Degrees of freedom
df <- a$df.residual
p_value <- 2 * (1 - pt(abs(t_stat), df))
p_value
# Degrees of freedom
df <- a$df.residual
p_value <- 2 * (1 - pt(abs(t_stat), df))
p_value
# Run regression with wife's and husband's BMI
a <- lm(famincome ~ bmi_w + bmi_h, data = married)
summary(a)
# Extract coefficients
b <- coef(a)
# Extract variance–covariance matrix
V <- vcov(a)
# Test H0: β_bmi_w = β_bmi_h
beta_diff <- b["bmi_w"] - b["bmi_h"]
# Variance of the difference:
# Var(β_w - β_h) = Var(β_w) + Var(β_h) - 2Cov(β_w, β_h)
var_diff <- V["bmi_w", "bmi_w"] +
V["bmi_h", "bmi_h"] -
2 * V["bmi_w", "bmi_h"]
# Test statistic
t_stat <- beta_diff / sqrt(var_diff)
# Degrees of freedom
df <- a$df.residual
# Two-sided p-value
p_value <- 2 * (1 - pt(abs(t_stat), df))
c(t_statistic = t_stat, p_value = p_value)
anova_out <- anova(lm_model)
anova_out
anova_out <- anova(lm_model)
anova_out
anova_out <- anova(lm_model)
anova_out
SSE<- anova_out["Residuals", "Sum Sq"]
SSR <- sum(anova_out[1:3, "Sum Sq"]) #sum of regression squares of all variables
SST <- SSR + SSE
df_SSE<- anova_out["Residuals", "Df"]
df_SSR <- sum(anova_out[1:3, "Df"]) #sum of regression squares of all variables
df_SST <- SSR + SSE
anova_out <- anova(lm_model)
anova_out
SSE<- anova_out["Residuals", "Sum Sq"]
SSR <- sum(anova_out[1:3, "Sum Sq"]) #sum of regression squares of all variables
SST <- SSR + SSE
df_SSE<- anova_out["Residuals", "Df"]
df_SSR <- sum(anova_out[1:3, "Df"]) #sum of regression squares of all variables
df_SST <- df_SSR + df_SSE
SSE
SSR
SST
df_SSE
mohoma <- read.csv("C:/Users/kzysi/Dropbox/Itam_teaching/Data/Survey_medioambiente/data/mohoma.csv")
View(mohoma)
# ---- Setup ----
library(tidyverse)
mohoma <- read.csv("C:/Users/kzysi/Dropbox/Itam_teaching/Data/Survey_medioambiente/data/mohoma.csv")
View(mohoma)
View(mohoma)
sum(!is.na(mohoma$bp_1_4kw))
personas<- read.csv("C:/Users/kzysi/Dropbox/Itam_teaching/Data/Survey_medioambiente/data/personas.csv")
persona <- read.csv("C:/Users/kzysi/Dropbox/Itam_teaching/Data/Survey_medioambiente/data/persona.csv")
View(persona)
