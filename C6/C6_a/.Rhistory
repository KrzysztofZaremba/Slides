model(
Mean = MEAN(Count),
`Naïve` = NAIVE(Count),
`Seasonal naïve` = SNAIVE(Count))%>%
forecast(h = 12)
forecast::accuracy(Preds, nsw_offences%>%
filter(Type=="Disorderly conduct"))
Preds=nsw_offences%>%
filter(year(Month)<2023)%>%
filter(Type=="Disorderly conduct")%>%
model(
Mean = MEAN(Count),
`Naïve` = NAIVE(Count),
`Seasonal naïve` = SNAIVE(Count))%>%
forecast(h = 12)
forecast::accuracy(Preds, nsw_offences%>%
filter(Type=="Disorderly conduct"))
Preds=nsw_offences%>%
filter(year(Month)<2024)%>% #you cannot evaluate a forecast for stuff which hasn't happened yet, it only works with the past values
filter(Type=="Disorderly conduct")%>%
model(
Mean = MEAN(Count),
`Naïve` = NAIVE(Count),
`Seasonal naïve` = SNAIVE(Count))%>%
forecast(h = 12)
forecast::accuracy(Preds, nsw_offences%>%
filter(Type=="Disorderly conduct"))
Preds=nsw_offences%>%
filter(year(Month)<2023)%>% #you cannot evaluate a forecast for stuff which hasn't happened yet, it only works with the past values
filter(Type=="Disorderly conduct")%>%
model(
Mean = MEAN(Count),
`Naïve` = NAIVE(Count),
`Seasonal naïve` = SNAIVE(Count))%>%
forecast(h = 12)
forecast::accuracy(Preds, nsw_offences%>%
filter(Type=="Disorderly conduct"))
forecast::accuracy(Preds, nsw_offences)
nsw_offences %>%
filter(Type == "Disorderly conduct") %>%
autoplot(Count)
nsw_offences %>%
filter(Type == "Disorderly conduct") %>%
model(NAIVE(Count)) %>%
forecast(h = "5 years") %>%
autoplot(nsw_offences)
nsw_offences %>%
filter(Type == "Disorderly conduct") %>%
model(SNAIVE(Count)) %>%
forecast(h = "5 years") %>%
autoplot(nsw_offences)
nsw_offences %>%
filter(Type == "Disorderly conduct") %>%
model(MEAN(Count)) %>%
forecast(h = "5 years") %>%
autoplot(nsw_offences)
nsw_offences %>%
filter(Type == "Disorderly conduct") %>%
mutate(
`12-MA` = slider::slide_dbl(Count, mean, .before = 11, .after = 0, .complete = TRUE)
) %>%
autoplot(Count, color = "gray") +
geom_line(aes(y = `12-MA`), colour = "#D55E00")
aus_fertility %>%
filter(Age == "18" & Region == "Australia") %>%
autoplot(Rate)
forecast::accuracy(Preds, nsw_offences)
aus_births
aus_births %>%
autoplot(Births)
aus_births %>%
filter(State=="QLD")
autoplot(Births)
aus_births %>%
filter(State=="QLD")%>%
autoplot(Births)
knitr::opts_chunk$set(echo = TRUE,dpi=300)
library(shiny)
library(ggplot2)
library(plotly)
library(igraph)
library(reshape)
library(spData)
library(leaflet)
library(readr)
library(ggplot2)
library(tidyverse)
library(gridExtra)
library(forecast)
library(gridExtra)
library(cowplot)
library(viridis)
library(gapminder)
library(knitr)
library(fpp3)
library(kableExtra)
library(DT)
library(feasts)
library(tsibble)
library(tsibbledata)
library(lubridate)
library(fable)
library(tsibbledata)
HT=ungroup(HT)
aus_births %>%
filter(State=="QLD")%>%
mutate(
`12-MA` = slider::slide_dbl(Count, mean, .before = 11, .after = 0, .complete = TRUE)
) %>%
autoplot(Count, color = "gray") +
geom_line(aes(y = `12-MA`), colour = "#D55E00")
aus_births %>%
filter(State=="QLD")%>%
mutate(
`12-MA` = slider::slide_dbl(Count, mean, .before = 6, .after = 5, .complete = TRUE)
) %>%
autoplot(Count, color = "gray") +
geom_line(aes(y = `12-MA`), colour = "#D55E00")
aus_births %>%
filter(State=="QLD")%>%
mutate(
`12-MA` = slider::slide_dbl(Births, mean, .before = 6, .after = 5, .complete = TRUE)
) %>%
autoplot(Count, color = "gray") +
geom_line(aes(y = `12-MA`), colour = "#D55E00")
aus_births %>%
filter(State=="QLD")%>%
mutate(
`12-MA` = slider::slide_dbl(Births, mean, .before = 6, .after = 5, .complete = TRUE)
) %>%
autoplot(Births, color = "gray") +
geom_line(aes(y = `12-MA`), colour = "#D55E00")
aus_births %>%
filter(State=="QLD")%>%
mutate(
`12-MA` = slider::slide_dbl(Births, mean, .before = 6, .after = 6, .complete = TRUE)
) %>%
autoplot(Births, color = "gray") +
geom_line(aes(y = `12-MA`), colour = "#D55E00")
aus_births %>%
filter(State=="QLD")%>%
mutate(
`12-MA` = slider::slide_dbl(Births, mean, .before = 5, .after = 5, .complete = TRUE)
) %>%
autoplot(Births, color = "gray") +
geom_line(aes(y = `12-MA`), colour = "#D55E00")
6
aus_births %>%
filter(State=="QLD")%>%
mutate(
`12-MA` = slider::slide_dbl(Births, mean, .before = 6, .after = 5, .complete = TRUE)
) %>%
autoplot(Births, color = "gray") +
geom_line(aes(y = `12-MA`), colour = "#D55E00")
a=aus_births%>%model(classical_decomposition(Births, type = "mult")) %>%
components()
%
aus_births %>%
filter(State=="QLD")%>%
mutate(
`12-MA` = slider::slide_dbl(Births, mean, .before = 6, .after = 5, .complete = TRUE)
)
aus_births=aus_births %>%
filter(State=="QLD")%>%
mutate(
`12-MA` = slider::slide_dbl(Births, mean, .before = 6, .after = 5, .complete = TRUE)
)
aus_births
View(aus_births)
aus_births %>%
autoplot(Births, color = "gray") +
geom_line(aes(y = `12-MA`), colour = "#D55E00")
aus_births=aus_births %>%
filter(State=="QLD")%>%
mutate(Factor_t=Births/`12-MA`)%>%
geom_line(aes(y = `12-MA`), colour = "#D55E00")
aus_births %>%
filter(State=="QLD")%>%
mutate(Factor_t=Births/`12-MA`)%>%
geom_line(aes(y = Factor_t), colour = "#D55E00")
aus_births %>%
filter(State=="QLD")%>%
mutate(Factor_t=Births/`12-MA`)%>%
autoplot(Births, color = "gray") +
geom_line(aes(y = Factor_t), colour = "#D55E00")
aus_births %>%
filter(State=="QLD")%>%
mutate(Factor_t=Births/`12-MA`)%>%
autoplot(Factor_t, color = "gray") +
geom_line(aes(y = Factor_t), colour = "#D55E00")
aus_births %>%
filter(State=="QLD")%>%
mutate(Factor_t=Births/`12-MA`)%>%
autoplot(Factor_t, color = "gray")
aus_births %>%
filter(State=="QLD")%>%
mutate(Factor_t=Births/`12-MA`)%>%
autoplot(Factor_t, color = "green")
aus_births %>%
filter(State=="QLD")%>%
mutate(Factor_t=Births/`12-MA`)%>%
autoplot(Factor_t, color = "red")
a=aus_births%>%model(classical_decomposition(Births, type = "mult")) %>%
components()
P=aus_births %>%
filter(State=="QLD")%>%
mutate(Factor_t=Births/`12-MA`)%>%
autoplot(Factor_t, color = "red")
{}
P
a=P%>%model(classical_decomposition(Births, type = "mult")) %>%
components()
aus_births%>%model(classical_decomposition(Births, type = "mult")) %>%
components()
aus_births%>%model(classical_decomposition(Births, type = "mult"))
aus_births%>%model(classical_decomposition(Births, type = "mult")) %>%
components()
aus_births%>%decompose(Births, type = "multiplicative") %>%
model(classical_decomposition(Births, type = "mult")) %>%
components()
aus_births%>%decompose(Births, type = "multiplicative")
aus_births%>%decompose(type = "multiplicative")
aus_births%>%decompose(Births)
elecequip
?decompose
aus_births %>%
autoplot(Births, color = "gray") %>%decompose(Births, type = "multiplicative")
aus_births %>%decompose(Births, type = "multiplicative")
decompose(aus_births)
stats::decompose(aus_births)
stats::decompose(aus_births$Births)
us_retail_employment |>
model(
classical_decomposition(Employed, type = "additive")
)
us_retail_employment |>
model(
classical_decomposition(Employed, type = "additive")
)
aus_births|>
model(
classical_decomposition(Births, type = "additive")
)
aus_births|>
model(
classical_decomposition(Births, type = "additive")
)  components() |>
aus_births|>
model(
classical_decomposition(Births, type = "additive")
) |>  components() |>
autoplot()
detach("package:igraph", unload = TRUE)
aus_births|>
model(
classical_decomposition(Births, type = "additive")
) |>  components() |>
autoplot()
?classical_decomposition
aus_births|>
model(
classical_decomposition(Births, type = "additive")
) |>  components()
seas=aus_births|>
model(
classical_decomposition(Births, type = "additive")
) |>  components()
seasonal=aus_births|>
model(
classical_decomposition(Births, type = "additive")
) |>  components()
seasonal
seasonal
seasonal[1:12]
seasonal[1:12,]
data.frame(Month=1:12, Seasonal_index=a$seasonal[1:12])
a=aus_births|>
model(
classical_decomposition(Births, type = "additive")
) |>  components()
data.frame(Month=1:12, Seasonal_index=a$seasonal[1:12])
a=aus_births|>
model(
classical_decomposition(Births, type = "multiplicative")
) |>  components()
data.frame(Month=1:12, Seasonal_index=a$seasonal[1:12])
aus_births %>%decompose(Births, type = "multiplicative")
aus_births %>%
autoplot(Births, color = "gray") +
geom_line(aes(y = `12-MA`), colour = "#D55E00")
P=aus_births %>%
filter(State=="QLD")%>%
mutate(Factor_t=Births/`12-MA`)%>%
autoplot(Factor_t, color = "red")
aus_births %>%decompose(Births, type = "multiplicative")
aus_births %>%
filter(State=="QLD")%>%
mutate(Factor_t=Births/`12-MA`)%>%
autoplot(Factor_t, color = "red")
aus_births %>%
filter(State=="QLD")%>%
fillter(year(Month)>2019)
aus_births %>%
filter(State=="QLD")%>%
filtter(year(Month)>2019)%>%
mutate(Factor_t=Births/`12-MA`)%>%
autoplot(Factor_t, color = "red")
aus_births %>%
filter(State=="QLD")%>%
filter(year(Month)>2019)%>%
mutate(Factor_t=Births/`12-MA`)%>%
autoplot(Factor_t, color = "red")
aus_births %>%
filter(State=="QLD")%>%
filter(year(Month)>2015)%>%
mutate(Factor_t=Births/`12-MA`)%>%
autoplot(Factor_t, color = "red")
aus_births %>%
filter(State=="QLD")%>%
mutate(Factor_t=Births/`12-MA`)%>%
autoplot(Factor_t, color = "red")
data.frame(Month=1:12, Seasonal_index=a$seasonal[1:12])
a=aus_births|>
model(
classical_decomposition(Births, type = "multiplicative")
) |>  components()
data.frame(Month=1:12, Seasonal_index=a$seasonal[1:12])
aus_mortality %>%
filter(Age=="85+" & Sex=="Total") %>%
autoplot(Mortality)
aus_mortality %>%
filter(Age=="85+" & Sex=="Total") %>%
autoplot(Mortality)
aus_mortality %>%
filter(Age=="85+" & Sex=="Total")
aus_mortality
aus_mortality %>%
filter(Age=="85+" & Sex=="Both") %>%
autoplot(Mortality)
a=aus_mortality|>
model(
classical_decomposition(Mortality, type = "multiplicative")
) |>  components()
a
View(a)
a=aus_births|>
model(
classical_decomposition(Births, type = "multiplicative")
) |>  components()
View(a)
a=aus_mortality|>
model(
classical_decomposition(Mortality, type = "multiplicative")
) |>  components() %>%autoplot()
aus_mortality|>
model(
classical_decomposition(Mortality, type = "multiplicative")
) |>  components() %>%autoplot()
aus_mortality
filter(Age=="85+" & Sex=="Both") %>%
model(
classical_decomposition(Mortality, type = "multiplicative")
) %>%  components() %>%autoplot()
aus_mortality %>%
filter(Age=="85+" & Sex=="Both") %>%
autoplot(Mortality)
a=aus_mortality%>%
filter(Age=="85+" & Sex=="Both") %>%
model(
classical_decomposition(Mortality, type = "multiplicative")
) %>%  components() %>%autoplot()
aus_mortality%>%
filter(Age=="85+" & Sex=="Both") %>%
model(
classical_decomposition(Mortality, type = "multiplicative")
) %>%  components() %>%autoplot()
aus_mortality%>%
filter(Age=="85+" & Sex=="Both") %>%
model(
classical_decomposition(Mortality, type = "multiplicative")
) %>%  components() %>%autoplot()
a=aus_mortality%>%
filter(Age=="85+" & Sex=="Both") %>%
model(
classical_decomposition(Mortality, type = "multiplicative")
) %>%  components()
data.frame(Week=1:52, Seasonal_index=a$seasonal[1:52])
plot(a$seasonal)
plot(a$seasonal[1:52])
m1=lm(`12-MA`~Month, data=aus_births))
m1=lm(`12-MA`~Month, data=aus_births)
summary(m1)
#plot the line vs the observations
aus_births %>%
autoplot(Births, color = "gray") +
geom_line(aes(y = `12-MA`), colour = "#D55E00")+
geom_line(aes(y=predict(m1)), color="blue")
aus_births %>%
autoplot(Births, color = "gray") +
geom_line(aes(y = `12-MA`), colour = "#D55E00")
aus_births %>%
autoplot(Births, color = "gray") +
geom_line(aes(y = `12-MA`), colour = "#D55E00")+
geom_line(aes(y=predict(m1)), color="blue")
aus_births$fitted=predict(m1)
aus_births$fitted= augment(m1)
m1 <- aus_births %>% model(MA = MA(Births ~ order = 12))
aus_births$fitted= augment(m1)
#keep oinly ccomplete data for the image
aus_births=aus_births %>%
filter(!is.na(`12-MA`))
aus_births$fitted= predict(m1)
autoplot(Births, color = "gray") +
geom_line(aes(y = `12-MA`), colour = "#D55E00")+
geom_line(aes(y=fitted), color="blue")
aus_births
#plot the line vs the observations
aus_births %>%
autoplot(Births, color = "gray") +
geom_line(aes(y = `12-MA`), colour = "#D55E00")+
geom_line(aes(y=fitted), color="blue")
aus_births=aus_births %>%
filter(State=="QLD")%>%
mutate(
`12-MA` = slider::slide_dbl(Births, mean, .before = 6, .after = 5, .complete = TRUE)
)
m1=lm(`12-MA`~Month, data=aus_births)
summary(m1)
#keep oinly ccomplete data for the image
aus_births=aus_births %>%
filter(!is.na(`12-MA`))
aus_births$fitted= predict(m1)
#detrend the series
aus_births=aus_births %>%
mutate(Cyclical=`12-MA`/fitted)
#plot
aus_births %>%
autoplot(Cyclical, color = "red")
#plot
aus_births %>%
autoplot(Cyclical, color = "red")+
autplot(Births)
#plot
aus_births %>%
autoplot(Cyclical, color = "red")+
autplot(Births, color = "gray")
#plot
aus_births %>%
autoplot(Cyclical, color = "red")
a=aus_births%>%
model(
classical_decomposition(Births, type = "multiplicative")
) %>%  components()
data.frame(Month=1:12, Seasonal_index=a$seasonal[1:12])
View(aus_births)
a=aus_births%>%
model(
classical_decomposition(Births, type = "multiplicative")
) %>%  components()
data.frame(Month=1:12, Seasonal_index=a$seasonal[1:12])
#seasonal factor in december:
dec_seasonal=a$seasonal[12]
dec_seasonal
dec_seasonal
#predict for december 2024
#find index of observation for december 2024
(2024−1976)×12+12=588
newdata <- data.frame(index = 588)
newdata
predict(m1, newdata)
new_data <- data.frame(Month=yearmonth("2024 Dec"))
predict(m1, newdata = new_data)
#keep oinly ccomplete data
aus_births=aus_births %>%
filter(!is.na(`12-MA`))
aus_births$fitted= predict(m1)
#detrend the series
aus_births=aus_births %>%
mutate(Cyclical=`12-MA`/fitted)
#plot
aus_births %>%
autoplot(Cyclical, color = "red")
#use the last value of cyclical component
dec_cyclical=tail(aus_births$Cyclical,1)
dec_cyclical
dec_cyclical
dec_cyclical
trend=predict(m1, newdata = new_data)
#step 4: combine to make predictions i
predicted_births=dec_seasonal*dec_cyclical*trend
predicted_births
#step 5 find the confidence interval
#find interval for the trend
pred_trend= predict(m1, newdata = new_data, interval="prediction", level=0.95)
pred_trend
pred_trend
#adjust by seasonal and cyclical
lower_bound=dec_seasonal*dec_cyclical*pred_trend[2]
upper_bound=dec_seasonal*dec_cyclical*pred_trend[3]
c(lower_bound, upper_bound)
aus_mortality
#week 52 for predictions
new_data=data(Week = yearweek(Week))
#week 52 for predictions
new_data=data(Week = yearweek("W52"))
#week 52 for predictions
new_data=data.frame(Week = yearweek("W52"))
#week 52 for predictions
new_data=data.frame(Week = yearweek("2025 W52"))
new_data
library(renderthis)
pagedown::chrome_print(input = "C_6_slides_a.html", output = "C_6_slides_a.pdf", timeout = 300)
